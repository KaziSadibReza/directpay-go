import{r as e,g as t,R as o,j as n,a as r,c as s}from"./client-B7OwZW8e.js";import{C as a}from"./CustomDropdown-JODbO0vG.js";const i={},l=e=>{let t;const o=new Set,n=(e,n)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=n?n:"object"!=typeof r||null===r)?r:Object.assign({},t,r),o.forEach(o=>o(t,e))}},r=()=>t,s={setState:n,getState:r,getInitialState:()=>a,subscribe:e=>(o.add(e),()=>o.delete(e)),destroy:()=>{"production"!==(i?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},a=t=e(n,r,s);return s};var c={exports:{}},d={},p={exports:{}},u={},m=e;var h="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},y=m.useState,g=m.useEffect,_=m.useLayoutEffect,f=m.useDebugValue;function v(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!h(e,o)}catch(n){return!0}}var x="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var o=t(),n=y({inst:{value:o,getSnapshot:t}}),r=n[0].inst,s=n[1];return _(function(){r.value=o,r.getSnapshot=t,v(r)&&s({inst:r})},[e,o,t]),g(function(){return v(r)&&s({inst:r}),e(function(){v(r)&&s({inst:r})})},[e]),f(o),o};u.useSyncExternalStore=void 0!==m.useSyncExternalStore?m.useSyncExternalStore:x,p.exports=u;var w=p.exports,b=e,S=w;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},N=S.useSyncExternalStore,k=b.useRef,C=b.useEffect,P=b.useMemo,E=b.useDebugValue;d.useSyncExternalStoreWithSelector=function(e,t,o,n,r){var s=k(null);if(null===s.current){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=P(function(){function e(e){if(!l){if(l=!0,s=e,e=n(e),void 0!==r&&a.hasValue){var t=a.value;if(r(t,e))return i=t}return i=e}if(t=i,j(s,e))return t;var o=n(e);return void 0!==r&&r(t,o)?(s=e,t):(s=e,i=o)}var s,i,l=!1,c=void 0===o?null:o;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,o,n,r]);var i=N(e,s[0],s[1]);return C(function(){a.hasValue=!0,a.value=i},[i]),E(i),i},c.exports=d;const L=t(c.exports),M={},{useDebugValue:T}=o,{useSyncExternalStoreWithSelector:O}=L;let I=!1;const A=e=>e;const D=e=>{"production"!==(M?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?l(e):l)(e):e,o=(e,o)=>function(e,t=A,o){"production"!==(M?"production":void 0)&&o&&!I&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),I=!0);const n=O(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,o);return T(n),n}(t,e,o);return Object.assign(o,t),o},R={en:{reference_label:"Order Reference",reference_placeholder:"Enter order reference",amount_label:"Amount",amount_placeholder:"0.00",email_label:"Email",email_placeholder:"your@email.com",first_name_label:"First Name",first_name_placeholder:"John",last_name_label:"Last Name",last_name_placeholder:"Doe",address_label:"Address",address_placeholder:"Street address",city_label:"City",city_placeholder:"City name",postcode_label:"Postal Code",postcode_placeholder:"12345",country_label:"Country",phone_label:"Phone",phone_placeholder:"+1 234 567 8900",order_details:"Order Details",customer_information:"Customer Information",shipping_method_label:"Shipping Method",payment_method_label:"Payment Method",order_summary:"Order Summary",subtotal:"Subtotal",shipping:"Shipping",total:"Total",free:"Free",place_order_button:"Place Order",processing:"Processing...",enter_address_for_shipping:"Please enter your postal code and city to see available shipping methods.",no_payment_methods:"No payment methods available.",loading_payment_methods:"Loading payment methods...",select_payment_method:"Select Payment Method",order_success_title:"Order Created Successfully!",order_number:"Order Number",reference:"Reference",payment_method:"Payment Method",status:"Status",required_field:"This field is required",invalid_email:"Please enter a valid email address",invalid_amount:"Amount must be greater than zero",bacs_description:"Make your payment directly into our bank account.",bacs_reference:"Please use your Order ID as the payment reference.",bacs_cleared:"Your order will not be shipped until the funds have cleared in our account.",check_send_to:"Please send a check to",cod_description:"Pay with cash upon delivery.",card_number:"Card Number",expiry_date:"Expiry Date",card_code:"Card Code",cvc:"CVC",select_pickup_location:"Select Your Pickup Location",choose_shipping_provider:"Choose Shipping Provider",choose_delivery_speed:"Choose Delivery Speed",express_delivery:"Express Delivery",normal_delivery:"Normal Delivery",select_pickup_point:"Select Pickup Point",choose_nearest_pickup:"Choose your nearest pickup point...",no_locations_available:"No pickup locations available in your country for this provider.",try_different_provider:"Try selecting a different provider or check if your country is supported.",loading_locations:"Loading locations...",shipping_manager:"Shipping Manager",manage_shipping:"Manage your shipping locations and pricing",add_location:"Add Location",save_changes:"Save Changes",location_name:"Location Name",express_price:"Express Price",normal_price:"Normal Price",delete_location:"Delete Location",confirm_delete:"Are you sure you want to delete this location?",active_sessions:"Active Shipping Sessions",session_id:"Session ID",customer:"Customer",expires:"Expires",actions:"Actions",view_details:"View Details",no_sessions:"No active sessions",languages:"Languages",installed:"Installed",not_installed:"Not Installed",download:"Download",download_all:"Download All Missing",first_order_benefits:"First Order Benefits",free_shipping_after_first:"After your first order, enjoy",free_shipping_badge:"FREE SHIPPING",free_shipping_duration:"on additional orders for the next 5 hours!",free_shipping_active:"Free Shipping Active!",order_in_session:"Order",in_this_session:"in this session",saved:"Saved",end_session:"End session",confirm_end_session:"Are you sure you want to end your free shipping session?"},fr:{reference_label:"R√©f√©rence de commande",reference_placeholder:"Entrez la r√©f√©rence",amount_label:"Montant",amount_placeholder:"0.00",email_label:"E-mail",email_placeholder:"votre@email.com",first_name_label:"Pr√©nom",first_name_placeholder:"Jean",last_name_label:"Nom",last_name_placeholder:"Dupont",address_label:"Adresse",address_placeholder:"Adresse de rue",city_label:"Ville",city_placeholder:"Nom de la ville",postcode_label:"Code postal",postcode_placeholder:"75001",country_label:"Pays",phone_label:"T√©l√©phone",phone_placeholder:"+33 1 23 45 67 89",order_details:"D√©tails de la commande",customer_information:"Informations client",shipping_method_label:"M√©thode de livraison",payment_method_label:"M√©thode de paiement",order_summary:"R√©capitulatif",subtotal:"Sous-total",shipping:"Livraison",total:"Total",free:"Gratuit",place_order_button:"Passer la commande",processing:"Traitement...",enter_address_for_shipping:"Veuillez entrer votre code postal et ville pour voir les m√©thodes de livraison.",no_payment_methods:"Aucune m√©thode de paiement disponible.",loading_payment_methods:"Chargement des m√©thodes de paiement...",select_payment_method:"S√©lectionner la m√©thode de paiement",order_success_title:"Commande cr√©√©e avec succ√®s!",order_number:"Num√©ro de commande",reference:"R√©f√©rence",payment_method:"M√©thode de paiement",status:"Statut",required_field:"Ce champ est requis",invalid_email:"Veuillez entrer une adresse e-mail valide",invalid_amount:"Le montant doit √™tre sup√©rieur √† z√©ro",bacs_description:"Effectuez votre paiement directement sur notre compte bancaire.",bacs_reference:"Veuillez utiliser votre num√©ro de commande comme r√©f√©rence de paiement.",bacs_cleared:"Votre commande ne sera pas exp√©di√©e tant que les fonds n'auront pas √©t√© cr√©dit√©s sur notre compte.",check_send_to:"Veuillez envoyer un ch√®que √†",cod_description:"Payez en esp√®ces √† la livraison.",card_number:"Num√©ro de carte",expiry_date:"Date d'expiration",card_code:"Code de carte",cvc:"CVC",select_pickup_location:"S√©lectionnez votre point de retrait",choose_shipping_provider:"Choisissez le transporteur",choose_delivery_speed:"Choisissez la vitesse de livraison",express_delivery:"Livraison Express",normal_delivery:"Livraison Standard",select_pickup_point:"S√©lectionnez le point de retrait",choose_nearest_pickup:"Choisissez votre point de retrait le plus proche...",no_locations_available:"Aucun point de retrait disponible dans votre pays pour ce transporteur.",try_different_provider:"Essayez de s√©lectionner un autre transporteur ou v√©rifiez si votre pays est pris en charge.",loading_locations:"Chargement des emplacements...",shipping_manager:"Gestionnaire de livraison",manage_shipping:"G√©rez vos emplacements de livraison et tarifs",add_location:"Ajouter un emplacement",save_changes:"Sauvegarder les modifications",location_name:"Nom de l'emplacement",express_price:"Prix Express",normal_price:"Prix Standard",delete_location:"Supprimer l'emplacement",confirm_delete:"√ätes-vous s√ªr de vouloir supprimer cet emplacement?",active_sessions:"Sessions de livraison actives",session_id:"ID de session",customer:"Client",expires:"Expire",actions:"Actions",view_details:"Voir les d√©tails",no_sessions:"Aucune session active",languages:"Langues",installed:"Install√©",not_installed:"Non install√©",download:"T√©l√©charger",download_all:"Tout t√©l√©charger",first_order_benefits:"Avantages de la premi√®re commande",free_shipping_after_first:"Apr√®s votre premi√®re commande, profitez de",free_shipping_badge:"LIVRAISON GRATUITE",free_shipping_duration:"sur les commandes suppl√©mentaires pendant les 5 prochaines heures!",free_shipping_active:"Livraison gratuite active!",order_in_session:"Commande",in_this_session:"dans cette session",saved:"√âconomis√©",end_session:"Terminer la session",confirm_end_session:"√ätes-vous s√ªr de vouloir terminer votre session de livraison gratuite?"},es:{reference_label:"Referencia del pedido",reference_placeholder:"Ingrese la referencia",amount_label:"Cantidad",amount_placeholder:"0.00",email_label:"Correo electr√≥nico",email_placeholder:"tu@email.com",first_name_label:"Nombre",first_name_placeholder:"Juan",last_name_label:"Apellido",last_name_placeholder:"Garc√≠a",address_label:"Direcci√≥n",address_placeholder:"Direcci√≥n de calle",city_label:"Ciudad",city_placeholder:"Nombre de ciudad",postcode_label:"C√≥digo postal",postcode_placeholder:"28001",country_label:"Pa√≠s",phone_label:"Tel√©fono",phone_placeholder:"+34 912 34 56 78",order_details:"Detalles del pedido",customer_information:"Informaci√≥n del cliente",shipping_method_label:"M√©todo de env√≠o",payment_method_label:"M√©todo de pago",order_summary:"Resumen del pedido",subtotal:"Subtotal",shipping:"Env√≠o",total:"Total",free:"Gratis",place_order_button:"Realizar pedido",processing:"Procesando...",enter_address_for_shipping:"Por favor ingrese su c√≥digo postal y ciudad para ver los m√©todos de env√≠o.",no_payment_methods:"No hay m√©todos de pago disponibles.",loading_payment_methods:"Cargando m√©todos de pago...",select_payment_method:"Seleccionar m√©todo de pago",order_success_title:"¬°Pedido creado exitosamente!",order_number:"N√∫mero de pedido",reference:"Referencia",payment_method:"M√©todo de pago",status:"Estado",required_field:"Este campo es obligatorio",invalid_email:"Por favor ingrese una direcci√≥n de correo v√°lida",invalid_amount:"La cantidad debe ser mayor que cero",bacs_description:"Realice su pago directamente en nuestra cuenta bancaria.",bacs_reference:"Por favor use su ID de pedido como referencia de pago.",bacs_cleared:"Su pedido no ser√° enviado hasta que los fondos se hayan acreditado en nuestra cuenta.",check_send_to:"Por favor env√≠e un cheque a",cod_description:"Pague en efectivo contra entrega.",card_number:"N√∫mero de tarjeta",expiry_date:"Fecha de vencimiento",card_code:"C√≥digo de tarjeta",cvc:"CVC",select_pickup_location:"Seleccione su punto de recogida",choose_shipping_provider:"Elija el proveedor de env√≠o",choose_delivery_speed:"Elija la velocidad de entrega",express_delivery:"Entrega Express",normal_delivery:"Entrega Est√°ndar",select_pickup_point:"Seleccione el punto de recogida",choose_nearest_pickup:"Elija su punto de recogida m√°s cercano...",no_locations_available:"No hay puntos de recogida disponibles en su pa√≠s para este proveedor.",try_different_provider:"Intente seleccionar otro proveedor o verifique si su pa√≠s es compatible.",loading_locations:"Cargando ubicaciones...",shipping_manager:"Gestor de env√≠os",manage_shipping:"Gestione sus ubicaciones de env√≠o y precios",add_location:"Agregar ubicaci√≥n",save_changes:"Guardar cambios",location_name:"Nombre de ubicaci√≥n",express_price:"Precio Express",normal_price:"Precio Est√°ndar",delete_location:"Eliminar ubicaci√≥n",confirm_delete:"¬øEst√° seguro de que desea eliminar esta ubicaci√≥n?",active_sessions:"Sesiones de env√≠o activas",session_id:"ID de sesi√≥n",customer:"Cliente",expires:"Caduca",actions:"Acciones",view_details:"Ver detalles",no_sessions:"No hay sesiones activas",languages:"Idiomas",installed:"Instalado",not_installed:"No instalado",download:"Descargar",download_all:"Descargar todos",first_order_benefits:"Beneficios del primer pedido",free_shipping_after_first:"Despu√©s de su primer pedido, disfrute de",free_shipping_badge:"ENV√çO GRATIS",free_shipping_duration:"en pedidos adicionales durante las pr√≥ximas 5 horas!",free_shipping_active:"¬°Env√≠o gratis activo!",order_in_session:"Pedido",in_this_session:"en esta sesi√≥n",saved:"Ahorrado",end_session:"Terminar sesi√≥n",confirm_end_session:"¬øEst√° seguro de que desea finalizar su sesi√≥n de env√≠o gratis?"},de:{reference_label:"Bestellreferenz",reference_placeholder:"Referenz eingeben",amount_label:"Betrag",amount_placeholder:"0.00",email_label:"E-Mail",email_placeholder:"ihre@email.de",first_name_label:"Vorname",first_name_placeholder:"Hans",last_name_label:"Nachname",last_name_placeholder:"Schmidt",address_label:"Adresse",address_placeholder:"Stra√üenadresse",city_label:"Stadt",city_placeholder:"Stadtname",postcode_label:"Postleitzahl",postcode_placeholder:"10115",country_label:"Land",phone_label:"Telefon",phone_placeholder:"+49 30 12345678",order_details:"Bestelldetails",customer_information:"Kundeninformationen",shipping_method_label:"Versandart",payment_method_label:"Zahlungsmethode",order_summary:"Bestell√ºbersicht",subtotal:"Zwischensumme",shipping:"Versand",total:"Gesamt",free:"Kostenlos",place_order_button:"Bestellung aufgeben",processing:"Verarbeitung...",enter_address_for_shipping:"Bitte geben Sie Ihre Postleitzahl und Stadt ein, um Versandmethoden zu sehen.",no_payment_methods:"Keine Zahlungsmethoden verf√ºgbar.",loading_payment_methods:"Zahlungsmethoden werden geladen...",select_payment_method:"Zahlungsmethode w√§hlen",order_success_title:"Bestellung erfolgreich erstellt!",order_number:"Bestellnummer",reference:"Referenz",payment_method:"Zahlungsmethode",status:"Status",required_field:"Dieses Feld ist erforderlich",invalid_email:"Bitte geben Sie eine g√ºltige E-Mail-Adresse ein",invalid_amount:"Der Betrag muss gr√∂√üer als Null sein",bacs_description:"Zahlen Sie direkt auf unser Bankkonto.",bacs_reference:"Bitte verwenden Sie Ihre Bestellnummer als Zahlungsreferenz.",bacs_cleared:"Ihre Bestellung wird erst versendet, wenn das Geld auf unserem Konto eingegangen ist.",check_send_to:"Bitte senden Sie einen Scheck an",cod_description:"Zahlung bei Lieferung in bar.",card_number:"Kartennummer",expiry_date:"Ablaufdatum",card_code:"Kartencode",cvc:"CVC",select_pickup_location:"W√§hlen Sie Ihren Abholort",choose_shipping_provider:"Versanddienstleister w√§hlen",choose_delivery_speed:"Liefergeschwindigkeit w√§hlen",express_delivery:"Express-Lieferung",normal_delivery:"Standard-Lieferung",select_pickup_point:"Abholpunkt w√§hlen",choose_nearest_pickup:"W√§hlen Sie Ihren n√§chsten Abholpunkt...",no_locations_available:"Keine Abholorte in Ihrem Land f√ºr diesen Anbieter verf√ºgbar.",try_different_provider:"Versuchen Sie einen anderen Anbieter oder pr√ºfen Sie, ob Ihr Land unterst√ºtzt wird.",loading_locations:"Standorte werden geladen...",shipping_manager:"Versandverwaltung",manage_shipping:"Verwalten Sie Ihre Versandstandorte und Preise",add_location:"Standort hinzuf√ºgen",save_changes:"√Ñnderungen speichern",location_name:"Standortname",express_price:"Express-Preis",normal_price:"Standard-Preis",delete_location:"Standort l√∂schen",confirm_delete:"Sind Sie sicher, dass Sie diesen Standort l√∂schen m√∂chten?",active_sessions:"Aktive Versandsessions",session_id:"Session-ID",customer:"Kunde",expires:"L√§uft ab",actions:"Aktionen",view_details:"Details anzeigen",no_sessions:"Keine aktiven Sessions",languages:"Sprachen",installed:"Installiert",not_installed:"Nicht installiert",download:"Herunterladen",download_all:"Alle herunterladen",first_order_benefits:"Vorteile der ersten Bestellung",free_shipping_after_first:"Nach Ihrer ersten Bestellung genie√üen Sie",free_shipping_badge:"KOSTENLOSER VERSAND",free_shipping_duration:"bei zus√§tzlichen Bestellungen f√ºr die n√§chsten 5 Stunden!",free_shipping_active:"Kostenloser Versand aktiv!",order_in_session:"Bestellung",in_this_session:"in dieser Session",saved:"Gespart",end_session:"Session beenden",confirm_end_session:"Sind Sie sicher, dass Sie Ihre kostenlose Versandsession beenden m√∂chten?"}},F={en:"English",fr:"Fran√ßais",es:"Espa√±ol",de:"Deutsch"},G=()=>{const e=(navigator.language||navigator.userLanguage).split("-")[0];return R[e]?e:"en"},V=(B=(e,t)=>{var o;return{config:null,language:"undefined"!=typeof localStorage&&localStorage.getItem("directpay_language")||G(),formData:{reference:"",amount:"",email:"",firstName:"",lastName:"",address:"",city:"",postcode:"",country:(null==(o=window.directPayConfig)?void 0:o.defaultCountry)||"FR",phone:""},shippingMethods:[],selectedShippingMethod:null,shippingLoading:!1,selectedPickupPoint:null,paymentMethods:[],selectedPaymentMethod:null,paymentLoading:!1,isLoading:!1,isProcessing:!1,errors:{},globalError:null,orderSuccess:!1,orderData:null,initializeConfig:t=>e({config:t}),updateFormData:(t,o)=>e(e=>({formData:{...e.formData,[t]:o},errors:{...e.errors,[t]:null},globalError:null})),batchUpdateFormData:t=>e(e=>({formData:{...e.formData,...t}})),setErrors:t=>e({errors:t,globalError:null}),setGlobalError:t=>e({globalError:t}),clearError:t=>e(e=>({errors:{...e.errors,[t]:null}})),setLoading:t=>e({isLoading:t}),setProcessing:t=>e({isProcessing:t}),setShippingMethods:t=>e({shippingMethods:t,shippingLoading:!1}),setShippingLoading:t=>e({shippingLoading:t}),selectShippingMethod:t=>e({selectedShippingMethod:t}),setPaymentMethods:t=>e({paymentMethods:t,paymentLoading:!1}),setPaymentLoading:t=>e({paymentLoading:t}),selectPaymentMethod:t=>e({selectedPaymentMethod:t}),setPickupPoint:t=>e({selectedPickupPoint:t}),clearPickupPoint:()=>e({selectedPickupPoint:null}),setOrderSuccess:(t,o=null)=>e({orderSuccess:t,orderData:o}),resetForm:()=>{var t;return e({formData:{reference:"",amount:"",email:"",firstName:"",lastName:"",address:"",city:"",postcode:"",country:(null==(t=window.directPayConfig)?void 0:t.defaultCountry)||"FR",phone:""},errors:{},globalError:null,selectedShippingMethod:null,selectedPaymentMethod:null,selectedPickupPoint:null,orderSuccess:!1,orderData:null})},validateField:(e,o)=>{const n=t().config,r=(null==n?void 0:n.translations)||{};if(!o||""===o.trim())return r.error_required||"This field is required";if("email"===e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o))return r.error_email||"Invalid email address";if("amount"===e){const e=parseFloat(o);if(isNaN(e)||e<=0)return r.error_amount||"Amount must be greater than 0"}return null},validateForm:()=>{const{formData:o,validateField:n}=t(),r={};return["reference","amount","email","firstName","lastName"].forEach(e=>{const t=n(e,o[e]);t&&(r[e]=t)}),e({errors:r}),0===Object.keys(r).length},setLanguage:t=>{"undefined"!=typeof localStorage&&localStorage.setItem("directpay_language",t),e({language:t})},t:e=>{const{language:o}=t();return((e,t="en")=>{var o;return(null==(o=R[t])?void 0:o[e])||R.en[e]||e})(e,o)}}})?D(B):D;var B;const $=()=>window.directPayConfig||{},z=async(e,t={})=>{const o={headers:{"Content-Type":"application/json","X-WP-Nonce":$().nonce},...t},n=await fetch(e,o);if(!n.ok){const e=await n.json();throw new Error(e.message||"API request failed")}return n.json()},q=async e=>{const t=$(),o={reference:e.formData.reference,amount:parseFloat(e.formData.amount),customer:{email:e.formData.email,first_name:e.formData.firstName,last_name:e.formData.lastName,address_1:e.formData.address,city:e.formData.city,postcode:e.formData.postcode,country:e.formData.country,phone:e.formData.phone},shipping_method:e.shippingMethod,payment_method:e.paymentMethod,locale:t.locale};e.paymentIntentId&&(o.payment_intent_id=e.paymentIntentId),e.pickupPoint&&(o.pickup_point=e.pickupPoint),void 0!==e.shippingCost&&(o.shipping_cost=parseFloat(e.shippingCost)),e.hasActiveSession&&(o.has_active_session=!0,o.session_id=e.sessionId),e.savePaymentMethod&&(o.save_payment_method=!0);return await z(`${t.apiUrl}/orders`,{method:"POST",body:JSON.stringify(o)})},U=(e,t=null)=>{const o=t||{},{currencySymbol:n="‚Ç¨",currencyPosition:r="left",currencyDecimals:s=2,currencyDecimalSeparator:a=".",currencyThousandSeparator:i=","}=o,l="string"==typeof e?parseFloat(e):e;if(isNaN(l))return`${n}0${a}00`;const c=l.toFixed(s).split("."),d=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,i),p=c[1],u=p?`${d}${a}${p}`:d;switch(r){case"left":default:return`${n}${u}`;case"right":return`${u}${n}`;case"left_space":return`${n} ${u}`;case"right_space":return`${u} ${n}`}},W=()=>n.jsxs("div",{className:"directpay-loading",children:[n.jsx("div",{className:"directpay-loading__spinner"}),n.jsx("p",{className:"directpay-loading__text",children:"Processing..."})]});var H,J="https://js.stripe.com",Z="".concat(J,"/").concat("clover","/stripe.js"),Y=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,K=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,Q=function(e){return Y.test(e)||K.test(e)},X=function(e){var t=document.createElement("script");t.src="".concat(Z).concat("");var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(t),t},ee=null,te=null,oe=null,ne=function(e){return null!==ee?ee:(ee=new Promise(function(t,o){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe)t(window.Stripe);else try{var n=function(){for(var e=document.querySelectorAll('script[src^="'.concat(J,'"]')),t=0;t<e.length;t++){var o=e[t];if(Q(o.src))return o}return null}();if(n&&e);else if(n){if(n&&null!==oe&&null!==te){var r;n.removeEventListener("load",oe),n.removeEventListener("error",te),null===(r=n.parentNode)||void 0===r||r.removeChild(n),n=X()}}else n=X();oe=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,o),te=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}}(o),n.addEventListener("load",oe),n.addEventListener("error",te)}catch(s){return void o(s)}else t(null)})).catch(function(e){return ee=null,Promise.reject(e)})};Promise.resolve().then(function(){return H||(H=ne(null).catch(function(e){return H=null,Promise.reject(e)}))}).catch(function(e){console.warn(e)});var re={exports:{}};function se(){}function ae(){}ae.resetWarningCache=se;re.exports=function(){function e(e,t,o,n,r,s){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==s){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var o={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ae,resetWarningCache:se};return o.PropTypes=o,o}();const ie=t(re.exports);function le(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function ce(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?le(Object(o),!0).forEach(function(t){pe(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):le(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ue(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)o=s[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)o=s[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==o)return;var n,r,s=[],a=!0,i=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(s.push(n.value),!t||s.length!==t);a=!0);}catch(l){i=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw r}}return s}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return he(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var ye=function(e,t,n){var r=!!n,s=o.useRef(n);o.useEffect(function(){s.current=n},[n]),o.useEffect(function(){if(!r||!e)return function(){};var o=function(){s.current&&s.current.apply(s,arguments)};return e.on(t,o),function(){e.off(t,o)}},[r,t,e,s])},ge=function(e){return null!==e&&"object"===de(e)},_e="[object Object]",fe=function e(t,o){if(!ge(t)||!ge(o))return t===o;var n=Array.isArray(t);if(n!==Array.isArray(o))return!1;var r=Object.prototype.toString.call(t)===_e;if(r!==(Object.prototype.toString.call(o)===_e))return!1;if(!r&&!n)return t===o;var s=Object.keys(t),a=Object.keys(o);if(s.length!==a.length)return!1;for(var i={},l=0;l<s.length;l+=1)i[s[l]]=!0;for(var c=0;c<a.length;c+=1)i[a[c]]=!0;var d=Object.keys(i);if(d.length!==s.length)return!1;var p=t,u=o;return d.every(function(t){return e(p[t],u[t])})},ve=function(e,t,o){return ge(e)?Object.keys(e).reduce(function(n,r){var s=!ge(t)||!fe(e[r],t[r]);return o.includes(r)?(s&&console.warn("Unsupported prop change: options.".concat(r," is not a mutable property.")),n):s?ce(ce({},n||{}),{},pe({},r,e[r])):n},null):null},xe=o.createContext(null);xe.displayName="ElementsContext";ie.any,ie.object,ie.func.isRequired;var we=o.createContext(null);we.displayName="CheckoutContext",ie.any,ie.shape({clientSecret:ie.oneOfType([ie.string,ie.instanceOf(Promise)]).isRequired,elementsOptions:ie.object}).isRequired;var be=function(e){var t=o.useContext(we),n=o.useContext(xe);if(t){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t}return function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e}(n,e)},Se=["mode"],je=function(e,t){var n,r="".concat((n=e).charAt(0).toUpperCase()+n.slice(1),"Element"),s=t?function(e){be("mounts <".concat(r,">"));var t=e.id,n=e.className;return o.createElement("div",{id:t,className:n})}:function(t){var n,s=t.id,a=t.className,i=t.options,l=void 0===i?{}:i,c=t.onBlur,d=t.onFocus,p=t.onReady,u=t.onChange,m=t.onEscape,h=t.onClick,y=t.onLoadError,g=t.onLoaderStart,_=t.onNetworksChange,f=t.onConfirm,v=t.onCancel,x=t.onShippingAddressChange,w=t.onShippingRateChange,b=t.onSavedPaymentMethodRemove,S=t.onSavedPaymentMethodUpdate,j=be("mounts <".concat(r,">")),N="elements"in j?j.elements:null,k="checkoutState"in j?j.checkoutState:null,C="success"===(null==k?void 0:k.type)||"loading"===(null==k?void 0:k.type)?k.sdk:null,P=me(o.useState(null),2),E=P[0],L=P[1],M=o.useRef(null),T=o.useRef(null);ye(E,"blur",c),ye(E,"focus",d),ye(E,"escape",m),ye(E,"click",h),ye(E,"loaderror",y),ye(E,"loaderstart",g),ye(E,"networkschange",_),ye(E,"confirm",f),ye(E,"cancel",v),ye(E,"shippingaddresschange",x),ye(E,"shippingratechange",w),ye(E,"savedpaymentmethodremove",b),ye(E,"savedpaymentmethodupdate",S),ye(E,"change",u),p&&(n="expressCheckout"===e?p:function(){p(E)}),ye(E,"ready",n),o.useLayoutEffect(function(){if(null===M.current&&null!==T.current&&(N||C)){var t=null;if(C)switch(e){case"paymentForm":t=C.createPaymentFormElement(l);break;case"payment":t=C.createPaymentElement(l);break;case"address":if(!("mode"in l))throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");var o=l.mode,n=ue(l,Se);if("shipping"===o)t=C.createShippingAddressElement(n);else{if("billing"!==o)throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.");t=C.createBillingAddressElement(n)}break;case"expressCheckout":t=C.createExpressCheckoutElement(l);break;case"currencySelector":t=C.createCurrencySelectorElement();break;case"taxId":t=C.createTaxIdElement(l);break;default:throw new Error("Invalid Element type ".concat(r,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else N&&(t=N.create(e,l));M.current=t,L(t),t&&t.mount(T.current)}},[N,C,l]);var O,I,A=(O=l,I=o.useRef(O),o.useEffect(function(){I.current=O},[O]),I.current);return o.useEffect(function(){if(M.current){var e=ve(l,A,["paymentRequest"]);e&&"update"in M.current&&M.current.update(e)}},[l,A]),o.useLayoutEffect(function(){return function(){if(M.current&&"function"==typeof M.current.destroy)try{M.current.destroy(),M.current=null}catch(e){}}},[]),o.createElement("div",{id:s,className:a,ref:T})};return s.propTypes={id:ie.string,className:ie.string,onChange:ie.func,onBlur:ie.func,onFocus:ie.func,onReady:ie.func,onEscape:ie.func,onClick:ie.func,onLoadError:ie.func,onLoaderStart:ie.func,onNetworksChange:ie.func,onConfirm:ie.func,onCancel:ie.func,onShippingAddressChange:ie.func,onShippingRateChange:ie.func,onSavedPaymentMethodRemove:ie.func,onSavedPaymentMethodUpdate:ie.func,options:ie.object},s.displayName=r,s.__elementType=e,s},Ne="undefined"==typeof window;o.createContext(null).displayName="EmbeddedCheckoutProviderContext",je("auBankAccount",Ne),je("card",Ne),je("cardNumber",Ne),je("cardExpiry",Ne),je("cardCvc",Ne),je("iban",Ne),je("payment",Ne),je("expressCheckout",Ne),je("paymentRequestButton",Ne),je("linkAuthentication",Ne),je("address",Ne),je("shippingAddress",Ne),je("paymentMethodMessaging",Ne),je("taxId",Ne);const ke=({paymentMethod:t,amount:o=0,fallback:r})=>{const[s,a]=e.useState(null),[i,l]=e.useState(!0),[c,d]=e.useState(!0);return e.useEffect(()=>{(async()=>{var e,o,n,r;try{console.log("[NativePaymentGateway] Loading native fields for:",t);const s=$();console.log("[NativePaymentGateway] API URL:",s.apiUrl);const i=await fetch(`${s.apiUrl}/payment-fields`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_method:t})});if(console.log("[NativePaymentGateway] Response status:",i.status),!i.ok){const e=await i.text();throw console.error("[NativePaymentGateway] Response error:",e),new Error("Failed to load native fields")}const c=await i.json();if(console.log("[NativePaymentGateway] Response data:",c),console.log("[NativePaymentGateway] HTML length:",null==(e=c.html)?void 0:e.length),console.log("[NativePaymentGateway] Scripts count:",null==(o=c.scripts)?void 0:o.length),c.scripts&&c.scripts.length>0){console.log("[NativePaymentGateway] Loading scripts...");for(const e of c.scripts)console.log("[NativePaymentGateway] Loading script:",e.handle,e.src),"wc-stripe"!==e.handle&&"wc-stripe-upe"!==e.handle||!e.params||(console.log("[NativePaymentGateway] Injecting Stripe params for:",e.handle,e.params),"wc-stripe-upe"===e.handle?(window.wc_stripe_upe_params={key:e.params.key,testMode:e.params.testmode,isCheckout:!0,isChangingPayment:!1,isSetupIntent:!1,isOrderPay:!1,isPayForOrder:!1,currency:"usd",country:"US",locale:"en",nonce:{checkout:(null==(n=window.directPayConfig)?void 0:n.nonce)||""},ajax_url:window.location.origin+"/wp-admin/admin-ajax.php",wcBlocksUPEAppearance:{},cartContainsSubscription:!1,showSavedCards:!1,showSaveOption:!1,showTerms:!1,terms:"",upeParams:{}},console.log("[NativePaymentGateway] Full wc_stripe_upe_params:",window.wc_stripe_upe_params)):(window.wc_stripe_params={key:e.params.key,testmode:e.params.testmode?"1":"0",inline_cc_form:"yes",is_checkout:"yes",return_url:window.location.origin+"/checkout/order-received/",ajaxurl:window.location.origin+"/wp-admin/admin-ajax.php",stripe_locale:"en",nonce:(null==(r=window.directPayConfig)?void 0:r.nonce)||"",statement_descriptor:"",elements_options:{},elements_styling:!1,elements_classes:!1,sepa_elements_options:{},is_change_payment_page:!1,is_add_payment_page:!1,is_pay_for_order_page:!1,elements_location:"checkout",is_product_page:!1,is_cart_page:!1},console.log("[NativePaymentGateway] Full wc_stripe_params:",window.wc_stripe_params))),await Ce(e.src,e.handle);console.log("[NativePaymentGateway] All scripts loaded")}a(c.html),l(!0),console.log("[NativePaymentGateway] Native rendering enabled")}catch(s){console.warn("[NativePaymentGateway] Native payment fields not available, using fallback:",s),l(!1)}finally{d(!1)}})()},[t]),e.useEffect(()=>{s&&i&&(console.log("[NativePaymentGateway] Initializing payment gateway, HTML injected"),requestAnimationFrame(()=>{setTimeout(async()=>{console.log("[NativePaymentGateway] Triggering WooCommerce events after RAF");const e=document.querySelector("#stripe-card-element");if(console.log("[NativePaymentGateway] #stripe-card-element found:",!!e),e)console.log("[NativePaymentGateway] #stripe-card-element has children:",e.children.length),console.log("[NativePaymentGateway] #stripe-card-element innerHTML:",e.innerHTML);else{const e=document.querySelectorAll('[id*="stripe"]');console.log('[NativePaymentGateway] Found elements with "stripe" in ID:',e.length),e.forEach(e=>console.log("[NativePaymentGateway] - Found:",e.id,e.tagName))}if(window.wc_stripe_upe_params&&window.Stripe&&window.wc_stripe_upe_params.key){if(console.log("[NativePaymentGateway] Attempting manual UPE initialization..."),console.log("[NativePaymentGateway] Stripe already loaded:",!!window.Stripe),window.directPayStripe&&window.directPayElements){console.log("[NativePaymentGateway] ‚ö†Ô∏è Stripe already initialized, updating amount instead");const e=Math.round(100*(o||0));console.log("[NativePaymentGateway] Updating Elements amount to:",e,"cents (",o,"BDT)");try{await window.directPayElements.update({amount:e}),console.log("[NativePaymentGateway] ‚úÖ Amount updated successfully")}catch(t){console.error("[NativePaymentGateway] ‚ùå Error updating amount:",t)}return}try{const e=window.Stripe(window.wc_stripe_upe_params.key);console.log("[NativePaymentGateway] Stripe instance created");$();const t=o||0;console.log("[NativePaymentGateway] Initial amount:",t),console.log("[NativePaymentGateway] Creating Elements with mode: payment (allows amount updates)");const n=Math.round(100*t),r=e.elements({mode:"payment",amount:n,currency:"bdt",appearance:{theme:"stripe"},locale:window.wc_stripe_upe_params.locale||"auto"});console.log("[NativePaymentGateway] Elements created with amount:",n,"cents");let s=document.querySelector("#wc-stripe-upe-element");if(!s){const e=document.querySelector("#wc-stripe-upe-form");e?(console.log("[NativePaymentGateway] Creating UPE element container..."),s=document.createElement("div"),s.id="wc-stripe-upe-element",e.insertBefore(s,e.firstChild)):console.log("[NativePaymentGateway] UPE form not found")}if(s){console.log("[NativePaymentGateway] Found/created UPE container, mounting Payment Element...");const t=r.create("payment",{layout:"tabs"});t.mount("#wc-stripe-upe-element"),console.log("[NativePaymentGateway] Payment Element mounted!"),t.on("change",e=>{var t;console.log("[NativePaymentGateway] Payment method changed:",e);const o=document.getElementById("place-order-button");if(o&&(null==(t=e.value)?void 0:t.type)){const t=e.value.type;console.log("[NativePaymentGateway] Payment type:",t),window.directPaySelectedPaymentType=t,o.textContent="google_pay"===t?"Pay with Google Pay":"apple_pay"===t?"Pay with Apple Pay":"link"===t?"Pay with Link":"Place Order"}}),window.directPayStripe=e,window.directPayElements=r,window.directPayPaymentElement=t,console.log("[NativePaymentGateway] Stripe instances stored globally")}else console.log("[NativePaymentGateway] Could not find or create UPE container")}catch(t){console.error("[NativePaymentGateway] Error initializing Stripe:",t)}}window.jQuery?(console.log("[NativePaymentGateway] jQuery available"),console.log("[NativePaymentGateway] window.Stripe available:",void 0!==window.Stripe),console.log("[NativePaymentGateway] window.wc_stripe_params:",window.wc_stripe_params),console.log("[NativePaymentGateway] window.wc_stripe_upe_params:",window.wc_stripe_upe_params),console.log("[NativePaymentGateway] Triggering updated_checkout..."),window.jQuery(document.body).trigger("updated_checkout"),console.log("[NativePaymentGateway] Triggering payment_method_selected..."),window.jQuery(document.body).trigger("payment_method_selected"),console.log("[NativePaymentGateway] Events triggered")):console.warn("[NativePaymentGateway] jQuery not available")},100)}))},[s,i,o]),c?n.jsxs("div",{className:"payment-gateway-loading",children:[n.jsx("div",{className:"spinner"}),n.jsx("p",{children:"Loading payment gateway..."})]}):i&&s?(console.log("[NativePaymentGateway] Rendering native HTML"),n.jsx("div",{className:"native-payment-gateway woocommerce-checkout-payment",id:"payment",dangerouslySetInnerHTML:{__html:s}})):(console.log("[NativePaymentGateway] Using fallback rendering"),r)},Ce=(e,t)=>new Promise((o,n)=>{if(document.getElementById(t))return void o();const r=document.createElement("script");r.id=t,r.src=e,r.onload=o,r.onerror=n,document.head.appendChild(r)}),Pe=({amount:t})=>{const[o,r]=e.useState([]),[s,a]=e.useState(null),[i,l]=e.useState(!0),{selectPaymentMethod:c,t:d}=V();return e.useEffect(()=>{(async()=>{console.log("[PaymentMethods] Loading payment methods..."),l(!0);const e=await(async()=>{const e=$();try{return(await z(`${e.apiUrl}/payment-methods`,{method:"GET"})).payment_methods||[]}catch(t){return console.error("Error fetching payment methods:",t),[]}})();console.log("[PaymentMethods] Loaded methods:",e),r(e),e.length>0&&(console.log("[PaymentMethods] Auto-selecting first method:",e[0].id),a(e[0].id),c(e[0].id)),l(!1)})()},[c]),i?n.jsxs("div",{className:"directpay-payment-loading",children:[n.jsx("div",{className:"spinner"}),n.jsx("p",{children:d("loading_payment_methods")})]}):0===o.length?n.jsx("div",{className:"directpay-payment-error",children:d("no_payment_methods")}):n.jsxs("div",{className:"directpay-payment-methods",children:[n.jsx("h3",{children:d("select_payment_method")}),n.jsx("div",{className:"payment-methods-list",children:o.map(e=>n.jsxs("div",{className:"payment-method-option "+(s===e.id?"selected":""),onClick:()=>{console.log("[PaymentMethods] Clicked payment method:",e.id),a(e.id),c(e.id),console.log("[PaymentMethods] Payment method selected:",e.id)},children:[n.jsx("input",{type:"radio",name:"payment_method",value:e.id,checked:s===e.id,onChange:()=>{console.log("[PaymentMethods] Radio changed to:",e.id),a(e.id),c(e.id)}}),n.jsxs("label",{children:[n.jsx("span",{className:"payment-method-title",children:e.title}),e.description&&n.jsx("span",{className:"payment-method-description",children:e.description})]})]},e.id))}),n.jsx("div",{className:"payment-method-content",children:s&&n.jsx(ke,{paymentMethod:s,amount:t},s)})]})},Ee=()=>{const{formData:t,selectedShippingMethod:o,selectedPickupPoint:r}=V(),[s,a]=e.useState(!1),[i,l]=e.useState(!1),[c,d]=e.useState(!1),p=e.useRef(null),u=e.useRef(null),m=e.useRef(null),h=e.useRef(null),y=e.useRef(!1);e.useEffect(()=>{const e=t.amount&&parseFloat(t.amount)>0,n=t.reference&&""!==t.reference.trim(),s=o&&r;return e&&n&&s&&!y.current?(console.log("[ExpressCheckout] Initializing with amount:",t.amount,"reference:",t.reference,"shipping:",o),y.current=!0,g()):e&&n&&s||(console.log("[ExpressCheckout] Waiting for all required fields. Has amount:",e,"Has reference:",n,"Has shipping:",s),y.current=!1),()=>{h.current&&clearTimeout(h.current),m.current&&m.current.unmount()}},[t.amount,t.reference,o,r]);const g=async()=>{try{const e=$(),n=await fetch(`${e.apiUrl}/express-checkout-params`),s=await n.json();if(!s.success||!s.data)return void console.log("[ExpressCheckout] Not available:",s.message||"No data");const{publishable_key:i,currency:c}=s.data,y=parseFloat(t.amount);if(!y||y<=0)return void console.log("[ExpressCheckout] Invalid amount:",t.amount);const g=parseFloat((null==r?void 0:r.price)||0),_=y+g,f=Math.round(100*_);console.log("[ExpressCheckout] Product amount:",y),console.log("[ExpressCheckout] Shipping cost:",g),console.log("[ExpressCheckout] Total with shipping:",_,"‚Üí",f,"cents");const v=window.Stripe(i),x=v.elements({mode:"payment",amount:f,currency:c.toLowerCase(),appearance:{theme:"stripe",variables:{borderRadius:"4px",spacingUnit:"6px"}}}),w=x.create("expressCheckout",{buttonType:{applePay:"buy",googlePay:"buy"},buttonTheme:{applePay:"black",googlePay:"black"},buttonHeight:48,paymentMethods:{applePay:"auto",googlePay:"auto",link:"auto",amazonPay:"never",paypal:"never"},layout:{overflow:"never"}});p.current&&(console.log("[ExpressCheckout] Mounting element to DOM..."),w.mount(p.current),console.log("[ExpressCheckout] Element mounted, waiting for ready event..."),u.current=x,m.current=w,console.log("[ExpressCheckout] Setting 5-second timeout for ready event..."),h.current=setTimeout(()=>{console.warn("[ExpressCheckout] ‚ö†Ô∏è Ready event did NOT fire after 5 seconds!"),console.warn("[ExpressCheckout] This usually means Stripe is still loading or encountered an error"),d(!0),a(!0)},5e3),w.on("ready",e=>{if(console.log("[ExpressCheckout] ========================================"),console.log("[ExpressCheckout] üîî READY EVENT FIRED!"),console.log("[ExpressCheckout] ========================================"),h.current&&(clearTimeout(h.current),h.current=null,console.log("[ExpressCheckout] Timeout cleared")),console.log("[ExpressCheckout] Full event object:",e),console.log("[ExpressCheckout] availablePaymentMethods:",e.availablePaymentMethods),e.availablePaymentMethods){const t=Object.keys(e.availablePaymentMethods),o=t.filter(t=>!0===e.availablePaymentMethods[t]);console.log("[ExpressCheckout] All methods in object:",t),console.log("[ExpressCheckout] Available methods (true):",o),o.length>0?(console.log("[ExpressCheckout] ‚úÖ PAYMENT METHODS AVAILABLE - Showing buttons!"),l(!0),d(!1),a(!0)):(console.log("[ExpressCheckout] ‚ùå NO PAYMENT METHODS AVAILABLE"),console.log("[ExpressCheckout] Reasons:"),console.log("[ExpressCheckout]   - Link: Not activated in test mode OR currency not supported"),console.log("[ExpressCheckout]   - Apple Pay: Domain not verified (plugin.local)"),console.log("[ExpressCheckout]   - Google Pay: Requires HTTPS (you are on HTTP)"),d(!0),a(!0))}else console.log("[ExpressCheckout] ‚ùå No availablePaymentMethods property in event"),d(!0),a(!0);console.log("[ExpressCheckout] ========================================")}),w.on("loaderror",e=>{console.error("[ExpressCheckout] Load error:",e),h.current&&clearTimeout(h.current),d(!0)}),w.on("click",async e=>{console.log("[ExpressCheckout] ========================================"),console.log("[ExpressCheckout] üîî CLICK EVENT FIRED"),console.log("[ExpressCheckout] Payment type:",e.expressPaymentType),console.log("[ExpressCheckout] Full event:",e),console.log("[ExpressCheckout] Resolving with requirements..."),console.log("[ExpressCheckout] ========================================");try{e.resolve({emailRequired:!0,phoneNumberRequired:!0,shippingAddressRequired:!1}),console.log("[ExpressCheckout] ‚úÖ Click event resolved (shipping pre-selected)")}catch(t){console.error("[ExpressCheckout] ‚ùå Error resolving click event:",t)}}),w.on("confirm",async n=>{var s,a,i,l;console.log("[ExpressCheckout] ========================================"),console.log("[ExpressCheckout] Confirm event triggered"),console.log("[ExpressCheckout] Event:",n),console.log("[ExpressCheckout] Billing Details:",n.billingDetails),console.log("[ExpressCheckout] ========================================");try{const c=n.billingDetails||{},d={method:o,pickupPoint:r};console.log("[ExpressCheckout] Using pre-selected shipping:",d);const p=(o||"").split("_"),u=p[0]||"chronopost",m=p[1]||"normal",h=parseFloat((null==r?void 0:r.price)||0),g=y+h;console.log("[ExpressCheckout] Product amount:",y),console.log("[ExpressCheckout] Shipping cost:",h),console.log("[ExpressCheckout] Total amount:",g);const _=(c.name||"").split(" "),f=_[0]||"",w=_.slice(1).join(" ")||"",b={reference:t.reference,amount:g,customer:{email:c.email||t.email,first_name:f,last_name:w,phone:c.phone||t.phone||"",address_1:t.address||(null==(s=c.address)?void 0:s.line1)||"",city:t.city||(null==(a=c.address)?void 0:a.city)||"",postcode:t.postcode||(null==(i=c.address)?void 0:i.postal_code)||"",country:t.country||(null==(l=c.address)?void 0:l.country)||"FR"},payment_method:"stripe",shipping:{provider:u,delivery_type:m,cost:h,pickup_point:r},locale:e.locale||"en_US"};console.log("[ExpressCheckout] Order data prepared:",b);const{error:S}=await x.submit();if(S)return console.error("[ExpressCheckout] ‚ùå Submit error:",S.message),void n.paymentFailed({reason:"fail"});console.log("[ExpressCheckout] Creating payment intent for:",g);const j=await fetch(`${e.apiUrl}/create-payment-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:g})});if(!j.ok)return console.error("[ExpressCheckout] ‚ùå Failed to create payment intent"),void n.paymentFailed({reason:"fail"});const{clientSecret:N,paymentIntentId:k}=await j.json();console.log("[ExpressCheckout] Payment intent created:",k),b.payment_intent_id=k,console.log("[ExpressCheckout] Creating order...");const C=await fetch(`${e.apiUrl}/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!C.ok){const e=await C.text();return console.error("[ExpressCheckout] ‚ùå Order creation failed:",e),void n.paymentFailed({reason:"fail"})}const P=await C.json();if(console.log("[ExpressCheckout] ‚úÖ Order created:",P),P.success){const{error:e}=await v.confirmPayment({elements:x,clientSecret:N,confirmParams:{return_url:window.location.origin+window.location.pathname+"?order="+P.order_id}});e&&(console.error("[ExpressCheckout] ‚ùå Payment confirmation failed:",e),n.paymentFailed({reason:"fail"}))}else console.error("[ExpressCheckout] ‚ùå Order creation failed:",P.message),n.paymentFailed({reason:"fail"})}catch(c){console.error("[ExpressCheckout] ‚ùå Exception:",c),n.paymentFailed({reason:"fail"})}}),w.on("cancel",e=>{console.log("[ExpressCheckout] ========================================"),console.log("[ExpressCheckout] ‚ùå CANCEL EVENT FIRED"),console.log("[ExpressCheckout] Full event:",e),console.log("[ExpressCheckout] Reason: User cancelled or error occurred"),console.log("[ExpressCheckout] ========================================")}),a(!0))}catch(e){console.error("[ExpressCheckout] Initialization error:",e),d(!0)}};return e.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]),c&&s?(console.log("[ExpressCheckout] Rendering warning message"),n.jsxs("div",{className:"express-checkout-container",style:{padding:"16px",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",marginBottom:"20px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[n.jsx("span",{style:{fontSize:"18px"},children:"‚ö†Ô∏è"}),n.jsx("strong",{children:"Express Checkout Not Available"})]}),n.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#856404"},children:"Apple Pay, Google Pay, and Link are not currently available. Common reasons:"}),n.jsxs("ul",{style:{margin:"0",paddingLeft:"20px",fontSize:"13px",color:"#856404"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Link not activated"})," - Go to Stripe Dashboard ‚Üí Settings ‚Üí Payment methods ‚Üí Enable Link"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Currency issue"})," - Link may not support BDT (Bangladesh Taka). Try USD/EUR"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"HTTP vs HTTPS"})," - Google Pay requires HTTPS (you're on HTTP)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Domain not verified"})," - Apple Pay requires domain verification"]})]}),n.jsxs("p",{style:{margin:"8px 0 0 0",fontSize:"13px",color:"#856404"},children:[n.jsx("strong",{children:"No problem!"})," You can still complete payment with card below."]})]})):s&&i?n.jsxs("div",{className:"express-checkout-container",children:[n.jsx("div",{ref:p,id:"express-checkout-element",className:"express-checkout-element"}),n.jsx("div",{className:"express-checkout-separator",children:n.jsx("span",{children:"Or pay with card"})})]}):n.jsx("div",{ref:p,id:"express-checkout-element",className:"express-checkout-element",style:{display:"none"}})},Le=({currentLanguage:e,onLanguageChange:t})=>{const o=Object.entries(F).map(([e,t])=>({value:e,label:t}));return n.jsx("div",{className:"directpay-language-selector",children:n.jsx(a,{options:o,value:e,onChange:t,placeholder:"Select language"})})},Me=({country:t,postcode:o,onShippingChange:s})=>{const[i,l]=e.useState(!1),[c,d]=e.useState(null),[p,u]=e.useState(null),[m,h]=e.useState(null),[y,g]=e.useState([]),[_,f]=e.useState({}),[v,x]=e.useState(!1),w=e.useRef(!1),b=e.useRef(t),{t:S,config:j}=V();e.useEffect(()=>{if(!w.current){console.log("[ShippingSelector] üîµ Starting localStorage restoration..."),w.current=!0,console.log("[ShippingSelector] üìç Set hasLoadedFromStorageRef.current = true");try{const e=localStorage.getItem("directpay_shipping_data");if(e){const o=JSON.parse(e);if(console.log("[ShippingSelector] Restoring from localStorage:",o),o.location&&o.location.country!==t)return console.log("[ShippingSelector] ‚ùå Country mismatch! Form country:",t,"Saved location country:",o.location.country),console.log("[ShippingSelector] ‚ùå NOT restoring shipping data - country does not match"),void console.log("[ShippingSelector] üîµ Finished localStorage restoration (skipped due to country mismatch)");console.log("[ShippingSelector] ‚úÖ Country matches (",t,"), proceeding with restoration"),r.flushSync(()=>{console.log("[ShippingSelector] üìç Setting showShipping = true"),l(!0),o.provider&&(console.log("[ShippingSelector] üìç Setting selectedProvider =",o.provider),d(o.provider)),o.deliveryType&&(console.log("[ShippingSelector] üìç Setting selectedDeliveryType =",o.deliveryType),u(o.deliveryType)),o.location&&(console.log("[ShippingSelector] üìç Setting selectedLocation =",o.location.name),h(o.location),console.log("[ShippingSelector] üìç Setting locations array with 1 item"),g([o.location]),void 0!==o.location.expressPrice&&void 0!==o.location.normalPrice&&(console.log("[ShippingSelector] üìç Setting pricing:",{express:o.location.expressPrice,normal:o.location.normalPrice}),f({express:o.location.expressPrice,normal:o.location.normalPrice}),console.log("[ShippingSelector] Restored pricing from location")))}),o.provider&&o.deliveryType&&o.location?(console.log("[ShippingSelector] Notifying parent with restored data:",o),null==s||s(o)):console.log("[ShippingSelector] Incomplete data, skipping notification:",o)}else console.log("[ShippingSelector] ‚ö†Ô∏è No saved shipping data found in localStorage")}catch(e){console.error("[ShippingSelector] Error loading saved data:",e)}console.log("[ShippingSelector] üîµ Finished localStorage restoration")}},[]),e.useEffect(()=>{console.log("[ShippingSelector] üî∏ Postcode effect triggered. Postcode:",o,"hasLoadedFromStorageRef.current:",w.current),o&&o.length>=3?(console.log("[ShippingSelector] ‚úÖ Postcode valid (>= 3 chars), setting showShipping = true"),l(!0)):(console.log("[ShippingSelector] ‚ö†Ô∏è Postcode invalid or empty"),w.current?(console.log("[ShippingSelector] ‚è≠Ô∏è Have saved data - hiding UI but NOT resetting selections"),l(!1)):(console.log("[ShippingSelector] üîÑ No saved data - hiding UI and resetting"),l(!1),N()))},[o,c,m]),e.useEffect(()=>{var e;if(console.log("[ShippingSelector] üî∏ Country effect triggered. Country:",t,"hasLoadedFromStorageRef.current:",w.current),!w.current)return void console.log("[ShippingSelector] ‚è≠Ô∏è Skipping country check - still loading from storage");if(t===b.current)return void console.log("[ShippingSelector] ‚è≠Ô∏è Country unchanged from initial (",t,"), NOT resetting");const o=localStorage.getItem("directpay_shipping_data");if(o)try{const n=JSON.parse(o);if(n.location&&n.location.country===t)return console.log("[ShippingSelector] ‚úÖ Country matches saved data (",t,"), NOT resetting"),void(b.current=t);console.log("[ShippingSelector] ‚ö†Ô∏è Country changed from",null==(e=n.location)?void 0:e.country,"to",t,"- Resetting to show error"),b.current=t,N()}catch(n){console.error("[ShippingSelector] Error parsing saved data:",n)}else console.log("[ShippingSelector] No saved data, updating initialCountryRef to:",t),b.current=t},[t]),e.useEffect(()=>{c&&t&&k()},[c,t]),e.useEffect(()=>{m&&p?null==s||s({provider:c,deliveryType:p,location:m,price:"express"===p?_.express:_.normal}):null==s||s(null)},[m,p]);const N=()=>{console.log("[ShippingSelector] ‚ùå RESETTING ALL SELECTIONS"),d(null),u(null),h(null),g([]),f({})},k=async()=>{var e;x(!0);try{const o=(null==(e=window.directPayConfig)?void 0:e.restUrl)||"/wp-json/",n="mondial_relay"===c?"mondial-relay":c,r=await fetch(`${o}directpay/v1/shipping/checkout-locations?type=${n}&country=${t}`,{method:"GET",credentials:"same-origin"});if(!r.ok)return console.warn("[ShippingSelector] No locations available for",t),g([]),f({}),void x(!1);const s=await r.json();Array.isArray(s)&&s.length>0?(g(s),s[0]&&f({express:s[0].expressPrice,normal:s[0].normalPrice})):(g([]),f({}))}catch(o){console.error("Error loading locations:",o),g([]),f({})}finally{x(!1)}},C=e=>{d(e),u(null),h(null),g([]),f({})},P=e=>{u(e),h(null)},E="chronopost"===c?"Chronopost":"Mondial Relay",L="express"===p?_.express:_.normal,M=y.map(e=>({value:e.id,label:e.displayName}));return console.log("[ShippingSelector] üé® RENDER STATE:",{showShipping:i,selectedProvider:c,selectedDeliveryType:p,selectedLocation:null==m?void 0:m.name,locationsCount:y.length,pricing:_,hasLoadedFromStorageRef:w.current}),i?n.jsxs("div",{className:"directpay-shipping-selector",children:[n.jsx("h3",{children:S("select_pickup_location")}),n.jsxs("div",{className:"shipping-provider-selection",children:[n.jsx("h4",{children:S("choose_shipping_provider")}),n.jsxs("div",{className:"shipping-provider-buttons",children:[n.jsxs("button",{type:"button",className:"shipping-provider-btn "+("chronopost"===c?"active":""),onClick:()=>C("chronopost"),children:[n.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:n.jsx("path",{d:"M12 2L4 7V17L12 22L20 17V7L12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Chronopost"]}),n.jsxs("button",{type:"button",className:"shipping-provider-btn "+("mondial_relay"===c?"active":""),onClick:()=>C("mondial_relay"),children:[n.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:n.jsx("path",{d:"M12 2L4 7V17L12 22L20 17V7L12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Mondial Relay"]})]})]}),c&&n.jsxs("div",{className:"shipping-delivery-selection",children:[n.jsx("h4",{children:S("choose_delivery_speed")}),v?n.jsxs("div",{className:"shipping-skeleton",children:[n.jsx("div",{className:"shipping-skeleton-item"}),n.jsx("div",{className:"shipping-skeleton-item"})]}):0===y.length?n.jsxs("div",{className:"shipping-no-locations",children:[n.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:n.jsx("path",{d:"M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),n.jsx("p",{children:S("no_locations_available")}),n.jsx("small",{children:S("try_different_provider")})]}):n.jsxs("div",{className:"shipping-delivery-buttons",children:[_.express>0&&n.jsxs("button",{type:"button",className:"shipping-delivery-btn "+("express"===p?"active":""),onClick:()=>P("express"),children:[n.jsxs("span",{className:"shipping-delivery-label",children:[n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[n.jsx("path",{d:"M16 3H1V16H16V3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M16 8H20L23 11V16H16V8Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("circle",{cx:"5.5",cy:"18.5",r:"2.5",stroke:"currentColor",strokeWidth:"2"}),n.jsx("circle",{cx:"18.5",cy:"18.5",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]}),S("express_delivery")]}),n.jsx("span",{className:"shipping-delivery-price",children:U(_.express,j)})]}),_.normal>0&&n.jsxs("button",{type:"button",className:"shipping-delivery-btn "+("normal"===p?"active":""),onClick:()=>P("normal"),children:[n.jsxs("span",{className:"shipping-delivery-label",children:[n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[n.jsx("path",{d:"M21 16V8C20.9996 7.64928 20.9071 7.30481 20.7315 7.00116C20.556 6.69751 20.3037 6.44536 20 6.27L13 2.27C12.696 2.09446 12.3511 2.00205 12 2.00205C11.6489 2.00205 11.304 2.09446 11 2.27L4 6.27C3.69626 6.44536 3.44398 6.69751 3.26846 7.00116C3.09294 7.30481 3.00036 7.64928 3 8V16C3.00036 16.3507 3.09294 16.6952 3.26846 16.9988C3.44398 17.3025 3.69626 17.5546 4 17.73L11 21.73C11.304 21.9055 11.6489 21.9979 12 21.9979C12.3511 21.9979 12.696 21.9055 13 21.73L20 17.73C20.3037 17.5546 20.556 17.3025 20.7315 16.9988C20.9071 16.6952 20.9996 16.3507 21 16Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M3.27002 6.96L12 12.01L20.73 6.96",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M12 22.08V12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),S("normal_delivery")]}),n.jsx("span",{className:"shipping-delivery-price",children:U(_.normal,j)})]})]})]}),c&&p&&y.length>0&&n.jsx("div",{className:"shipping-location-selection",children:n.jsx(a,{label:`${S("select_pickup_point")} ${E}`,options:M,value:(null==m?void 0:m.id)||"",onChange:e=>{const t=y.find(t=>t.id===e);h(t)},placeholder:S("choose_nearest_pickup")})}),m&&n.jsx("div",{className:"shipping-summary",children:n.jsx("div",{className:"shipping-summary-content",children:n.jsxs("div",{className:"shipping-summary-row",children:[n.jsxs("div",{className:"shipping-summary-left",children:[n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[n.jsx("path",{d:"M9 11L12 14L22 4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M21 12V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),n.jsxs("div",{className:"shipping-summary-info",children:[n.jsxs("span",{className:"shipping-summary-provider",children:[E," ","express"===p?"Express":"Normal"]}),n.jsx("span",{className:"shipping-summary-location",children:m.name}),n.jsxs("span",{className:"shipping-summary-address",children:[m.address,", ",m.postalCode," ",m.city]})]})]}),n.jsx("div",{className:"shipping-summary-price",children:U(L,j)})]})})})]}):(console.log("[ShippingSelector] ‚õî Not rendering - showShipping is false"),null)},Te=()=>{const[t,o]=e.useState(null),[r,s]=e.useState(!0),[a,i]=e.useState(0),{t:l,config:c}=V();e.useEffect(()=>{d();const e=setInterval(d,3e4);return()=>clearInterval(e)},[]),e.useEffect(()=>{if(!t)return;i(t.remaining_seconds);const e=setInterval(()=>{i(e=>e<=1?(d(),0):e-1)},1e3);return()=>clearInterval(e)},[t]);const d=async()=>{var e;try{const t=(null==(e=window.directPayConfig)?void 0:e.restUrl)||"/wp-json/",n=await fetch(`${t}directpay/v1/shipping-session/status`,{credentials:"same-origin"}),r=await n.json();r.active?o(r):o(null)}catch(t){console.error("Error checking session:",t),o(null)}finally{s(!1)}};if(r)return null;if(!t)return n.jsxs("div",{className:"directpay-session-status no-session",children:[n.jsx("svg",{className:"session-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:n.jsx("path",{d:"M20 7L12 3L4 7M20 7L12 11M20 7V17L12 21M12 11L4 7M12 11V21M4 7V17L12 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),n.jsxs("div",{className:"session-content",children:[n.jsx("h4",{children:l("first_order_benefits")}),n.jsxs("p",{children:[l("free_shipping_after_first")," ",n.jsx("strong",{children:l("free_shipping_badge")})," ",l("free_shipping_duration")]})]})]});const p=(u=a,{hours:Math.floor(u/3600),minutes:Math.floor(u%3600/60),seconds:u%60});var u;return n.jsxs("div",{className:"directpay-session-status active-session",children:[n.jsxs("svg",{className:"session-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[n.jsx("path",{d:"M9 11L12 14L22 4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M21 12V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),n.jsxs("div",{className:"session-content",children:[n.jsx("h4",{children:l("free_shipping_active")}),n.jsxs("p",{children:[t.order_count>1&&n.jsxs("span",{className:"order-count",children:[l("order_in_session")," ",t.order_count," ",l("in_this_session")]}),t.total_saved>0&&n.jsxs("span",{className:"savings",children:[l("saved")," ",(null==c?void 0:c.currencySymbol)||"‚Ç¨",t.total_saved.toFixed(2)]})]})]}),n.jsxs("div",{className:"session-timer",children:[n.jsxs("div",{className:"timer-display",children:[p.hours>0&&n.jsxs("div",{className:"time-unit",children:[n.jsx("span",{className:"time-value",children:p.hours}),n.jsx("span",{className:"time-label",children:"h"})]}),n.jsxs("div",{className:"time-unit",children:[n.jsx("span",{className:"time-value",children:p.minutes.toString().padStart(2,"0")}),n.jsx("span",{className:"time-label",children:"m"})]}),n.jsxs("div",{className:"time-unit",children:[n.jsx("span",{className:"time-value",children:p.seconds.toString().padStart(2,"0")}),n.jsx("span",{className:"time-label",children:"s"})]})]}),n.jsx("button",{type:"button",className:"btn-clear-session",onClick:async()=>{var e;if(confirm(l("confirm_end_session")))try{const t=(null==(e=window.directPayConfig)?void 0:e.restUrl)||"/wp-json/";await fetch(`${t}directpay/v1/shipping-session/clear`,{method:"POST",credentials:"same-origin"}),o(null)}catch(t){console.error("Error clearing session:",t)}},title:l("end_session"),children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:n.jsx("path",{d:"M12 4L4 12M4 4L12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]})]})},Oe=({onClose:t})=>{const[o,r]=e.useState([]),[s,a]=e.useState([]),[i,l]=e.useState(!1),[c,d]=e.useState({totalOrders:0,totalSessions:0,totalSpent:0});e.useEffect(()=>{p()},[]);const p=()=>{try{const e=localStorage.getItem("directpay_order_history");if(e){const t=JSON.parse(e);r(t);const o={};let n=0;t.forEach(e=>{const t=e.session_id||"no-session";o[t]||(o[t]={id:t,orders:[],totalAmount:0,date:e.created_at}),o[t].orders.push(e),o[t].totalAmount+=parseFloat(e.total||0),n+=parseFloat(e.total||0)});const s=Object.values(o).sort((e,t)=>new Date(t.date)-new Date(e.date));a(s),d({totalOrders:t.length,totalSessions:s.length,totalSpent:n})}}catch(e){console.error("Error loading order history:",e)}},u=(e,t="BDT")=>`${t} ${parseFloat(e).toFixed(2)}`;return n.jsx("div",{className:"order-history-overlay",onClick:t,children:n.jsxs("div",{className:"order-history",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"order-history__header",children:[n.jsx("h2",{className:"order-history__title",children:"Your Orders"}),n.jsxs("div",{className:"order-history__actions",children:[o.length>0&&n.jsxs("button",{className:"btn-refresh",onClick:async()=>{if(0!==o.length){l(!0);try{const e=window.directPayConfig,t=(null==e?void 0:e.apiUrl)||"/wp-json/directpay/v1",n=await Promise.all(o.map(async e=>{try{const o=await fetch(`${t}/orders/${e.order_id}/status`);if(o.ok){const t=await o.json();return{...e,status:t.status,payment_method_title:t.payment_method_title||e.payment_method_title}}}catch(o){console.error(`Error fetching status for order ${e.order_id}:`,o)}return e}));localStorage.setItem("directpay_order_history",JSON.stringify(n)),p()}catch(e){console.error("Error refreshing order statuses:",e)}finally{l(!1)}}},disabled:i,title:"Refresh order statuses from server",children:[n.jsx("svg",{className:i?"spinning":"",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M21 10C21 10 18.995 7.26822 17.3662 5.63824C15.7373 4.00827 13.4864 3 11 3C6.02944 3 2 7.02944 2 12C2 16.9706 6.02944 21 11 21C15.1031 21 18.5649 18.2543 19.6482 14.5M21 10V4M21 10H15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),i?"Refreshing...":"Refresh"]}),n.jsx("button",{className:"order-history__close",onClick:t,children:n.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),0===o.length?n.jsxs("div",{className:"order-history__empty",children:[n.jsxs("svg",{className:"order-history__empty-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("path",{d:"M9 2C9 2 3 3 3 8V9C3 13.5 5.5 17 9 18.5M15 2C15 2 21 3 21 8V9C21 13.5 18.5 17 15 18.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M9 22V18.5M15 22V18.5M9 18.5C10.5 19.5 13.5 19.5 15 18.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),n.jsx("p",{className:"order-history__empty-text",children:"No orders yet"}),n.jsx("p",{className:"order-history__empty-subtitle",children:"Your order history will appear here"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"order-history__stats",children:[n.jsxs("div",{className:"order-history__stat",children:[n.jsx("span",{className:"stat-label",children:"Total Orders"}),n.jsx("span",{className:"stat-value",children:c.totalOrders})]}),n.jsxs("div",{className:"order-history__stat",children:[n.jsx("span",{className:"stat-label",children:"Sessions"}),n.jsx("span",{className:"stat-value",children:c.totalSessions})]}),n.jsxs("div",{className:"order-history__stat",children:[n.jsx("span",{className:"stat-label",children:"Total Spent"}),n.jsx("span",{className:"stat-value",children:u(c.totalSpent)})]})]}),n.jsx("div",{className:"order-history__content",children:s.map((e,t)=>n.jsxs("div",{className:"order-history__session",children:[n.jsxs("div",{className:"session-header",children:[n.jsx("h3",{className:"session-title",children:"no-session"===e.id?"Individual Orders":"Session "+(s.length-t)}),n.jsxs("div",{className:"session-meta",children:[n.jsxs("span",{className:"session-count",children:[e.orders.length," order",e.orders.length>1?"s":""]}),n.jsx("span",{className:"session-total",children:u(e.totalAmount)})]})]}),n.jsx("div",{className:"session-orders",children:e.orders.map(e=>{return n.jsxs("div",{className:"order-card",children:[n.jsxs("div",{className:"order-card__header",children:[n.jsxs("div",{className:"order-info",children:[n.jsxs("span",{className:"order-number",children:["#",e.order_number]}),n.jsx("span",{className:"order-reference",children:e.reference})]}),n.jsx("span",{className:`order-status order-status--${o=e.status,{completed:"success",processing:"warning",pending:"info",failed:"error",cancelled:"error"}[o]||"info"}`,children:e.status})]}),n.jsxs("div",{className:"order-card__details",children:[n.jsxs("div",{className:"detail-row",children:[n.jsx("span",{className:"detail-label",children:"Date"}),n.jsx("span",{className:"detail-value",children:(t=e.created_at,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),n.jsxs("div",{className:"detail-row",children:[n.jsx("span",{className:"detail-label",children:"Amount"}),n.jsx("span",{className:"detail-value",children:u(e.subtotal,e.currency)})]}),e.shipping_total>0&&n.jsxs("div",{className:"detail-row",children:[n.jsx("span",{className:"detail-label",children:"Shipping"}),n.jsx("span",{className:"detail-value",children:u(e.shipping_total,e.currency)})]}),n.jsxs("div",{className:"detail-row detail-row--total",children:[n.jsx("span",{className:"detail-label",children:"Total"}),n.jsx("span",{className:"detail-value",children:u(e.total,e.currency)})]}),e.payment_method_title&&n.jsxs("div",{className:"detail-row",children:[n.jsx("span",{className:"detail-label",children:"Payment"}),n.jsx("span",{className:"detail-value",children:e.payment_method_title})]})]})]},e.order_id);var t,o})})]},e.id))}),n.jsxs("div",{className:"order-history__footer",children:[n.jsx("button",{className:"btn-clear",onClick:()=>{window.confirm("Are you sure you want to clear your order history? This cannot be undone.")&&(localStorage.removeItem("directpay_order_history"),r([]),a([]),d({totalOrders:0,totalSessions:0,totalSpent:0}))},children:"Clear History"}),n.jsx("p",{className:"footer-note",children:"Orders are stored locally on this device only"})]})]})]})})},Ie=()=>{const[t,o]=e.useState(null),[r,s]=e.useState(null),[i,l]=e.useState(!1),c=e.useRef(null),d=e.useRef(null),p=e=>{try{const t={order_id:e.order_id,order_number:e.order_number,reference:g.reference,total:e.total,subtotal:e.subtotal,shipping_total:e.shipping_total,currency:e.currency,status:e.status,payment_method_title:e.payment_method_title,session_id:(null==r?void 0:r.session_id)||null,created_at:(new Date).toISOString()},o=localStorage.getItem("directpay_order_history"),n=o?JSON.parse(o):[];n.unshift(t),n.length>50&&n.splice(50),localStorage.setItem("directpay_order_history",JSON.stringify(n))}catch(t){console.error("Error saving order to history:",t)}},{config:u,language:m,setLanguage:h,t:y,formData:g,errors:_,globalError:f,paymentMethods:v,selectedPaymentMethod:x,paymentLoading:w,isProcessing:b,orderSuccess:S,orderData:j,updateFormData:N,batchUpdateFormData:k,selectPaymentMethod:C,setPaymentMethods:P,setPaymentLoading:E,setProcessing:L,setGlobalError:M,setOrderSuccess:T,validateForm:O,selectShippingMethod:I,setPickupPoint:A}=V();e.useEffect(()=>{const e=localStorage.getItem("directpay_form_data");if(e)try{const t=JSON.parse(e);t.timestamp&&Date.now()-t.timestamp<6048e5?(k(t.data),console.log("[Checkout] Restored form data from localStorage:",t.data)):(localStorage.removeItem("directpay_form_data"),console.log("[Checkout] Removed expired form data"))}catch(n){console.error("[Checkout] Error loading saved data:",n)}const t=localStorage.getItem("directpay_shipping_data");if(t)try{const e=JSON.parse(t);o(e),console.log("[Checkout] Restored shipping data from localStorage:",e),e.provider&&e.deliveryType&&(I(`${e.provider}_${e.deliveryType}`),e.location&&A({...e.location,price:e.price}),console.log("[Checkout] ‚úÖ Updated Zustand store with shipping data"))}catch(n){console.error("[Checkout] Error loading shipping data:",n)}},[k,I,A]),e.useEffect(()=>{t&&(localStorage.setItem("directpay_shipping_data",JSON.stringify(t)),console.log("[Checkout] ‚úÖ Auto-saved shipping data:",t))},[t]),e.useEffect(()=>{const e={data:{email:g.email,firstName:g.firstName,lastName:g.lastName,address:g.address,city:g.city,postcode:g.postcode,country:g.country,phone:g.phone},timestamp:Date.now()};Object.entries(e.data).some(([e,t])=>t&&""!==t.toString().trim()&&!("country"===e&&"FR"===t))?(localStorage.setItem("directpay_form_data",JSON.stringify(e)),console.log("[Checkout] ‚úÖ Auto-saved form data:",e.data)):console.log("[Checkout] ‚è≠Ô∏è Not saving - no meaningful data entered yet")},[g]),e.useEffect(()=>{(async()=>{try{const e=await fetch("/wp-json/directpay/v1/shipping-session/status",{credentials:"same-origin"}),t=await e.json();t.active?(s(t),console.log("[Checkout] Active session found:",t)):s(null)}catch(e){console.error("[Checkout] Error checking session:",e),s(null)}})()},[]);return e.useEffect(()=>{b&&c.current&&c.current.scrollIntoView({behavior:"smooth",block:"center"})},[b]),e.useEffect(()=>{f&&d.current&&d.current.scrollIntoView({behavior:"smooth",block:"start"})},[f]),S&&j?n.jsx("div",{className:"directpay-checkout",children:n.jsx("div",{className:"directpay-success",children:n.jsxs("div",{className:"directpay-success__content",children:[n.jsx("div",{className:"directpay-success__icon-wrapper",children:n.jsxs("svg",{className:"directpay-success__icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.5"}),n.jsx("path",{d:"M8 12.5L10.5 15L16 9.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),n.jsx("h2",{className:"directpay-success__title",children:"Order Created Successfully"}),n.jsx("p",{className:"directpay-success__subtitle",children:"Your order has been received and is being processed"}),n.jsxs("div",{className:"directpay-success__details",children:[n.jsxs("div",{className:"directpay-success__detail-item",children:[n.jsx("span",{className:"detail-label",children:"Order Number"}),n.jsxs("span",{className:"detail-value",children:["#",j.order_number]})]}),n.jsxs("div",{className:"directpay-success__detail-item",children:[n.jsx("span",{className:"detail-label",children:"Reference"}),n.jsx("span",{className:"detail-value",children:g.reference})]}),n.jsxs("div",{className:"directpay-success__detail-item",children:[n.jsx("span",{className:"detail-label",children:"Payment Method"}),n.jsx("span",{className:"detail-value",children:j.payment_method_title||"Not specified"})]})]}),n.jsxs("div",{className:"directpay-success__summary",children:[n.jsxs("div",{className:"summary-row",children:[n.jsx("span",{className:"summary-label",children:"Subtotal"}),n.jsxs("span",{className:"summary-value",children:[j.currency," ",j.subtotal]})]}),n.jsxs("div",{className:"summary-row summary-row--total",children:[n.jsx("span",{className:"summary-label",children:"Total"}),n.jsxs("span",{className:"summary-value",children:[j.currency," ",j.total]})]})]}),n.jsx("div",{className:"directpay-success__status",children:n.jsx("span",{className:`status-badge status-badge--${j.status}`,children:j.status})}),n.jsx("div",{className:"directpay-success__actions",children:n.jsxs("button",{className:"btn-place-another-order",onClick:()=>{window.location.reload()},children:[n.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{d:"M19 12H5M5 12L12 19M5 12L12 5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),n.jsx("span",{children:"Place Another Order"})]})})]})})}):n.jsxs("div",{className:"directpay-checkout",children:[n.jsxs("div",{className:"directpay-checkout__body",children:[n.jsx(Te,{}),n.jsxs("div",{className:"directpay-checkout__header",children:[n.jsx(Le,{currentLanguage:m,onLanguageChange:h}),n.jsxs("button",{type:"button",className:"btn-view-orders",onClick:()=>l(!0),children:[n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("path",{d:"M9 2C9 2 3 3 3 8V9C3 13.5 5.5 17 9 18.5M15 2C15 2 21 3 21 8V9C21 13.5 18.5 17 15 18.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M9 22V18.5M15 22V18.5M9 18.5C10.5 19.5 13.5 19.5 15 18.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),n.jsx("span",{children:"My Orders"})]})]}),b&&n.jsx(W,{}),n.jsx(Ee,{}),n.jsxs("form",{className:"directpay-form",onSubmit:async e=>{e.preventDefault();const o={data:{email:g.email,firstName:g.firstName,lastName:g.lastName,address:g.address,city:g.city,postcode:g.postcode,country:g.country,phone:g.phone},timestamp:Date.now()};if(localStorage.setItem("directpay_form_data",JSON.stringify(o)),console.log("[Checkout] üíæ Saved shipping info before order submission"),!O())return void M("Please fill in all required fields correctly.");if(console.log("[Checkout] Form Validation - Selected Payment Method:",x),console.log("[Checkout] Form Validation - Payment Methods:",v),!x)return console.error("[Checkout] ‚ùå No payment method selected!"),void M("Please select a payment method.");const n=document.querySelector(`input[name="wc-${x}-new-payment-method"]`),s=!!n&&n.checked;console.log("[Checkout] Save payment method:",s),console.log("[Checkout] ‚úÖ Payment method selected:",x),L(!0),M(null);try{if("stripe"===x&&window.directPayStripe&&window.directPayElements){console.log("[Checkout] ========================================"),console.log("[Checkout] Processing Stripe payment..."),console.log("[Checkout] Stripe instance:",window.directPayStripe),console.log("[Checkout] Elements instance:",window.directPayElements),console.log("[Checkout] Payment Element:",window.directPayPaymentElement),console.log("[Checkout] ========================================");const e=parseFloat(g.amount)||0;console.log("[Checkout] Total:",e);const o=window.directPaySelectedPaymentType;console.log("[Checkout] Payment type:",o);const n=["google_pay","apple_pay","link"].includes(o);let i;if(console.log("[Checkout] Is wallet payment:",n),console.log("[Checkout] Submitting payment element..."),n){console.log("[Checkout] Wallet payment - submitting elements (will open wallet modal)");const{error:t}=await window.directPayElements.submit();if(t)throw console.error("[Checkout] ‚ùå Submit error:",t),new Error(t.message);console.log("[Checkout] ‚úÖ Wallet submitted successfully"),console.log("[Checkout] Creating payment intent with total:",e);const o=await fetch(`${u.apiUrl}/create-payment-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e})});if(!o.ok)throw new Error("Failed to create payment intent");const{clientSecret:n,paymentIntentId:r}=await o.json();console.log("[Checkout] Payment intent created:",r);const{paymentIntent:s,error:a}=await window.directPayStripe.retrievePaymentIntent(n);if(a)throw new Error(a.message);i=s,console.log("[Checkout] Payment Intent Status:",i.status)}else{console.log("[Checkout] Card payment - submitting then confirming");const{error:t}=await window.directPayElements.submit();if(t)throw console.error("[Checkout] ‚ùå Submit error:",t),new Error(t.message);console.log("[Checkout] ‚úÖ Payment element submitted successfully"),console.log("[Checkout] Creating payment intent with total:",e);const o=await fetch(`${u.apiUrl}/create-payment-intent`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e})});if(!o.ok)throw new Error("Failed to create payment intent");const{clientSecret:n,paymentIntentId:r}=await o.json();console.log("[Checkout] Payment intent created:",r),console.log("[Checkout] Confirming card payment...");const{error:s,paymentIntent:a}=await window.directPayStripe.confirmPayment({elements:window.directPayElements,clientSecret:n,confirmParams:{return_url:window.location.origin+window.location.pathname,payment_method_data:{billing_details:{name:`${g.firstName} ${g.lastName}`,email:g.email,phone:g.phone,address:{line1:g.address,city:g.city,state:g.state||"",postal_code:g.postcode,country:g.country}}}},redirect:"if_required"});if(s)throw console.error("[Checkout] ‚ùå Payment confirmation error:",s),console.error("[Checkout] Error code:",s.code),console.error("[Checkout] Error type:",s.type),new Error(s.message);i=a}if(console.log("[Checkout] Payment confirmed successfully!"),console.log("[Checkout] Payment Intent ID:",i.id),console.log("[Checkout] Payment Intent Status:",i.status),console.log("[Checkout] Payment Intent:",i),n&&i.payment_method){console.log("[Checkout] Extracting addresses from wallet payment...");try{const e=i.payment_method;if(console.log("[Checkout] Payment Method:",e),"object"==typeof e&&e.billing_details){const o=e.billing_details;console.log("[Checkout] Billing Details from wallet:",o);const n={...g,email:o.email||g.email,phone:o.phone||g.phone};if(o.name){const e=o.name.split(" ");n.firstName=e[0]||g.firstName,n.lastName=e.slice(1).join(" ")||g.lastName}o.address&&(n.address=o.address.line1||g.address,n.city=o.address.city||g.city,n.state=o.address.state||g.state,n.postcode=o.address.postal_code||g.postcode,n.country=o.address.country||g.country),console.log("[Checkout] Updated form data with wallet addresses:",n);const a=r?0:(null==t?void 0:t.price)||0,l=await q({formData:n,paymentMethod:x,paymentIntentId:i.id,shippingMethod:(null==t?void 0:t.provider)&&(null==t?void 0:t.deliveryType)?`directpay_shipping_${t.provider}_${t.deliveryType}`:null,pickupPoint:(null==t?void 0:t.location)||null,shippingCost:a,hasActiveSession:!!r,sessionId:(null==r?void 0:r.session_id)||null,savePaymentMethod:s});return p(l),void T(!0,l)}}catch(a){console.error("[Checkout] Error extracting wallet addresses:",a)}}const l=r?0:(null==t?void 0:t.price)||0,c=await q({formData:g,paymentMethod:x,paymentIntentId:i.id,shippingMethod:(null==t?void 0:t.provider)&&(null==t?void 0:t.deliveryType)?`directpay_shipping_${t.provider}_${t.deliveryType}`:null,pickupPoint:(null==t?void 0:t.location)||null,shippingCost:l,hasActiveSession:!!r,sessionId:(null==r?void 0:r.session_id)||null,savePaymentMethod:s});p(c),T(!0,c)}else{const e=r?0:(null==t?void 0:t.price)||0,o=await q({formData:g,paymentMethod:x,shippingMethod:(null==t?void 0:t.provider)&&(null==t?void 0:t.deliveryType)?`directpay_shipping_${t.provider}_${t.deliveryType}`:null,pickupPoint:(null==t?void 0:t.location)||null,shippingCost:e,hasActiveSession:!!r,sessionId:(null==r?void 0:r.session_id)||null,savePaymentMethod:s});p(o),T(!0,o)}}catch(i){console.error("[Checkout] Payment error:",i),M(i.message||"Failed to process payment. Please try again.")}finally{L(!1)}},ref:c,children:[f&&n.jsx("div",{className:"directpay-alert directpay-alert--error",ref:d,children:f}),n.jsxs("div",{className:"directpay-form__section",children:[n.jsx("h2",{className:"directpay-form__section-title",children:y("order_details")}),n.jsxs("div",{className:"directpay-form__row",children:[n.jsxs("div",{className:"directpay-form__field",children:[n.jsxs("label",{htmlFor:"reference",className:"directpay-form__label",children:[y("reference_label"),n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{type:"text",id:"reference",className:"directpay-form__input "+(_.reference?"error":""),value:g.reference,onChange:e=>N("reference",e.target.value),placeholder:y("reference_placeholder")}),_.reference&&n.jsx("span",{className:"directpay-form__error",children:_.reference})]}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsxs("label",{htmlFor:"amount",className:"directpay-form__label",children:[y("amount_label"),n.jsx("span",{className:"required",children:"*"})]}),n.jsxs("div",{className:"directpay-form__input-group",children:[n.jsx("span",{className:"directpay-form__input-prefix",children:(null==u?void 0:u.currencySymbol)||"‚Ç¨"}),n.jsx("input",{type:"text",inputMode:"decimal",id:"amount",min:"0",className:"directpay-form__input "+(_.amount?"error":""),value:g.amount,onChange:e=>{const t=e.target.value;(""===t||/^\d*\.?\d*$/.test(t))&&N("amount",t)},placeholder:y("amount_placeholder")})]}),_.amount&&n.jsx("span",{className:"directpay-form__error",children:_.amount})]})]})]}),n.jsxs("div",{className:"directpay-form__section",children:[n.jsx("h2",{className:"directpay-form__section-title",children:y("customer_information")}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsxs("label",{htmlFor:"email",className:"directpay-form__label",children:[y("email_label"),n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{type:"email",id:"email",className:"directpay-form__input "+(_.email?"error":""),value:g.email,onChange:e=>N("email",e.target.value),placeholder:y("email_placeholder")}),_.email&&n.jsx("span",{className:"directpay-form__error",children:_.email})]}),n.jsxs("div",{className:"directpay-form__row",children:[n.jsxs("div",{className:"directpay-form__field",children:[n.jsxs("label",{htmlFor:"firstName",className:"directpay-form__label",children:[y("first_name_label"),n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{type:"text",id:"firstName",className:"directpay-form__input "+(_.firstName?"error":""),value:g.firstName,onChange:e=>N("firstName",e.target.value)}),_.firstName&&n.jsx("span",{className:"directpay-form__error",children:_.firstName})]}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsxs("label",{htmlFor:"lastName",className:"directpay-form__label",children:[y("last_name_label"),n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{type:"text",id:"lastName",className:"directpay-form__input "+(_.lastName?"error":""),value:g.lastName,onChange:e=>N("lastName",e.target.value)}),_.lastName&&n.jsx("span",{className:"directpay-form__error",children:_.lastName})]})]}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsx("label",{htmlFor:"address",className:"directpay-form__label",children:y("address_label")}),n.jsx("input",{type:"text",id:"address",className:"directpay-form__input",value:g.address,onChange:e=>N("address",e.target.value)})]}),n.jsxs("div",{className:"directpay-form__row",children:[n.jsxs("div",{className:"directpay-form__field",children:[n.jsx("label",{htmlFor:"city",className:"directpay-form__label",children:y("city_label")}),n.jsx("input",{type:"text",id:"city",className:"directpay-form__input",value:g.city,onChange:e=>N("city",e.target.value)})]}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsx("label",{htmlFor:"postcode",className:"directpay-form__label",children:y("postcode_label")}),n.jsx("input",{type:"text",id:"postcode",className:"directpay-form__input",value:g.postcode,onChange:e=>N("postcode",e.target.value)})]})]}),n.jsxs("div",{className:"directpay-form__row",children:[n.jsx("div",{className:"directpay-form__field",children:n.jsx(a,{label:y("country_label"),options:(null==u?void 0:u.countries)?Object.entries(u.countries).map(([e,t])=>({value:e,label:t})):[],value:g.country,onChange:e=>N("country",e),placeholder:"Select country...",searchable:!0})}),n.jsxs("div",{className:"directpay-form__field",children:[n.jsx("label",{htmlFor:"phone",className:"directpay-form__label",children:y("phone_label")}),n.jsx("input",{type:"tel",id:"phone",className:"directpay-form__input",value:g.phone,onChange:e=>N("phone",e.target.value)})]})]})]}),n.jsxs("div",{className:"directpay-form__section",children:[n.jsx("h2",{className:"directpay-form__section-title",children:"Shipping Method"}),n.jsx(Me,{country:g.country,postcode:g.postcode,onShippingChange:e=>{o(e),e?(I(`${e.provider}_${e.deliveryType}`),A({...e.location,price:e.price})):(I(null),A(null))}})]}),n.jsxs("div",{className:"directpay-form__section",children:[n.jsx("h2",{className:"directpay-form__section-title",children:y("payment_method_label")}),!g.amount||parseFloat(g.amount)<=0?n.jsx("div",{className:"directpay-info-message",style:{textAlign:"center",padding:"20px",color:"#666"},children:n.jsx("p",{children:y("Enter Amount First")||"Please enter an amount above to see payment methods."})}):n.jsx(Pe,{amount:(parseFloat(g.amount)||0)+(r?0:(null==t?void 0:t.price)||0)})]}),n.jsxs("div",{className:"directpay-form__section directpay-order-summary",children:[n.jsx("h2",{className:"directpay-form__section-title",children:y("order_summary")}),n.jsxs("div",{className:"directpay-summary",children:[n.jsxs("div",{className:"directpay-summary__row",children:[n.jsxs("span",{className:"directpay-summary__label",children:[y("subtotal"),":"]}),n.jsx("span",{className:"directpay-summary__value",children:U(g.amount||0,u)})]}),t&&n.jsxs("div",{className:"directpay-summary__row",children:[n.jsxs("span",{className:"directpay-summary__label",children:["Shipping (","chronopost"===t.provider?"Chronopost":"Mondial Relay"," - ","express"===t.deliveryType?"Express":"Normal","):"]}),n.jsx("span",{className:"directpay-summary__value",children:r?n.jsx("span",{className:"free-shipping",children:"FREE - Already paid on first order"}):U(t.price,u)})]}),n.jsxs("div",{className:"directpay-summary__row directpay-summary__row--total",children:[n.jsxs("span",{className:"directpay-summary__label",children:[y("total"),":"]}),n.jsx("span",{className:"directpay-summary__value",children:U((parseFloat(g.amount)||0)+(r?0:(null==t?void 0:t.price)||0),u)})]})]})]}),n.jsx("div",{className:"directpay-form__actions",children:n.jsx("button",{type:"submit",className:"directpay-button directpay-button--primary directpay-button--large",disabled:b,id:"place-order-button",children:y(b?"processing":"place_order_button")})})]})]}),i&&n.jsx(Oe,{onClose:()=>l(!1)})]})};function Ae(){const{initializeConfig:t}=V();return e.useEffect(()=>{window.directPayConfig&&t(window.directPayConfig)},[t]),n.jsx("div",{className:"directpay-checkout-container",children:n.jsx(Ie,{})})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("directpay-checkout-root");if(e){s.createRoot(e).render(n.jsx(o.StrictMode,{children:n.jsx(Ae,{})}))}});
