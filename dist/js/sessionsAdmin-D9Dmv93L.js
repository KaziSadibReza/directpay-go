import{r as e,j as s,a as i,R as n}from"./client-C4Hiuctl.js";import{c as a,P as t,U as l,S as o}from"./users-DEmqVik0.js";
/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r=a("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),d=a("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),c=a("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),h=a("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),x=a("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),u=a("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),p=a("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),g=a("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),m=a("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),f=a("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),j=a("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),v=a("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),y=()=>{const[i,n]=e.useState(null),[a,l]=e.useState(null),[o,r]=e.useState(!0);e.useEffect(()=>{d()},[]);const d=async()=>{var e,s,i;try{const a=(null==(e=window.directpayGoAdmin)?void 0:e.wpVersion)||"N/A",t=(null==(s=window.directpayGoAdmin)?void 0:s.wcVersion)||"N/A",o=(null==(i=window.directpayGoAdmin)?void 0:i.phpVersion)||"N/A";l({pluginVersion:"1.0.0",wpVersion:a,wcVersion:t,phpVersion:o}),n({totalOrders:0,activeLanguages:1,shippingMethods:3,paymentGateways:2})}catch(a){console.error("Error fetching data:",a)}finally{r(!1)}};return o?s.jsx("div",{className:"overview-tab",children:s.jsx("div",{className:"loading",children:"Loading..."})}):s.jsxs("div",{className:"overview-tab",children:[s.jsxs("div",{className:"hero",children:[s.jsx("h2",{children:"Welcome to DirectPay Go"}),s.jsx("p",{children:"High-performance custom checkout for WooCommerce, optimized for 500+ concurrent visitors."})]}),s.jsxs("div",{className:"stats-grid",children:[s.jsx(b,{icon:t,label:"Total Orders",value:(null==i?void 0:i.totalOrders)||0}),s.jsx(b,{icon:u,label:"Active Languages",value:(null==i?void 0:i.activeLanguages)||1}),s.jsx(b,{icon:h,label:"Payment Gateways",value:(null==i?void 0:i.paymentGateways)||0}),s.jsx(b,{icon:j,label:"Shipping Methods",value:(null==i?void 0:i.shippingMethods)||0})]}),s.jsxs("div",{className:"section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 1v6m0 6v6"}),s.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"System Information"]}),s.jsxs("div",{className:"info-grid",children:[s.jsx(w,{label:"Plugin Version",value:null==a?void 0:a.pluginVersion}),s.jsx(w,{label:"WordPress",value:null==a?void 0:a.wpVersion}),s.jsx(w,{label:"WooCommerce",value:null==a?void 0:a.wcVersion,status:"success"}),s.jsx(w,{label:"PHP Version",value:null==a?void 0:a.phpVersion})]})]})]})},b=({icon:e,label:i,value:n})=>s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(e,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:n}),s.jsx("div",{className:"stat-label",children:i})]})]}),w=({label:e,value:i,status:n})=>s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:e}),s.jsxs("span",{className:"info-value "+("success"===n?"success":""),children:["success"===n&&s.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"4px"},children:s.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),i]})]}),k=()=>{var i,n;const[a,t]=e.useState([]),[l,o]=e.useState(!0),[c,h]=e.useState({}),g=null==(i=window.directpayGoAdmin)?void 0:i.ajaxUrl,m=null==(n=window.directpayGoAdmin)?void 0:n.nonce,f=[{locale:"en_US",name:"English",flag:"ðŸ‡ºðŸ‡¸",isDefault:!0},{locale:"fr_FR",name:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·",isDefault:!1},{locale:"es_ES",name:"EspaÃ±ol",flag:"ðŸ‡ªðŸ‡¸",isDefault:!1},{locale:"de_DE",name:"Deutsch",flag:"ðŸ‡©ðŸ‡ª",isDefault:!1}];e.useEffect(()=>{j()},[]);const j=async()=>{try{const e=new FormData;e.append("action","directpay_check_languages"),e.append("nonce",m);const s=await fetch(g,{method:"POST",body:e}),i=await s.json();if(console.log("Language status response:",i),i.success&&i.data.languages){const e=i.data.languages.map(e=>({locale:e.locale,name:e.name,flag:e.flag,installed:Boolean(e.is_default)||Boolean(e.installed),isDefault:Boolean(e.is_default),installedDate:e.installed_date,filePath:e.file_path}));console.log("Mapped languages:",e),t(e)}else console.error("Failed to load languages:",i),t(f)}catch(e){console.error("Error checking languages:",e),t(f)}finally{o(!1)}},v=async(e,s)=>{var i;h(s=>({...s,[e]:!0}));try{const n=new FormData;n.append("action","directpay_download_translation"),n.append("nonce",m),n.append("locale",e);const a=await fetch(g,{method:"POST",body:n}),t=await a.json();t.success?(alert(`âœ… ${s} translation downloaded successfully!`),j()):alert(`âŒ Error: ${(null==(i=t.data)?void 0:i.message)||"Failed to download translation"}`)}catch(n){console.error("Error downloading translation:",n),alert(`âŒ Error downloading ${s} translation`)}finally{h(s=>({...s,[e]:!1}))}};if(l)return s.jsxs("div",{style:S.loading,children:[s.jsx(p,{size:32,color:"#667eea",style:{animation:"spin 1s linear infinite"}}),s.jsx("p",{children:"Loading language information..."})]});const y=a.filter(e=>e.isDefault||e.installed).length,b=a.length;return s.jsxs("div",{children:[s.jsxs("div",{style:S.header,children:[s.jsxs("div",{children:[s.jsx("h2",{style:S.title,children:"Language Management"}),s.jsxs("p",{style:S.subtitle,children:["DirectPay Go supports ",b," languages. WooCommerce translation files are required for automatic translation."]})]}),s.jsxs("div",{style:S.badge,children:[y,"/",b," Installed"]})]}),s.jsxs("div",{style:S.statsRow,children:[s.jsxs("div",{style:S.statBox,children:[s.jsx(u,{size:24,color:"#667eea"}),s.jsxs("div",{children:[s.jsx("div",{style:S.statValue,children:b}),s.jsx("div",{style:S.statLabel,children:"Supported Languages"})]})]}),s.jsxs("div",{style:S.statBox,children:[s.jsx(d,{size:24,color:"#48bb78"}),s.jsxs("div",{children:[s.jsx("div",{style:S.statValue,children:y}),s.jsx("div",{style:S.statLabel,children:"Installed Translations"})]})]}),a.filter(e=>!e.isDefault&&!e.installed).length>0&&s.jsxs("div",{style:S.statBox,children:[s.jsx(r,{size:24,color:"#f59e0b"}),s.jsxs("div",{children:[s.jsx("div",{style:S.statValue,children:a.filter(e=>!e.isDefault&&!e.installed).length}),s.jsx("div",{style:S.statLabel,children:"Missing Translations"})]})]})]}),a.some(e=>!e.isDefault&&!e.installed)&&s.jsx("div",{style:S.bulkActions,children:s.jsxs("button",{style:S.bulkButton,onClick:async()=>{const e=a.filter(e=>!e.isDefault&&!e.installed);for(const s of e)await v(s.locale,s.name)},disabled:Object.values(c).some(e=>e),children:[s.jsx(x,{size:18}),"Download All Missing Translations"]})}),s.jsx("div",{style:S.languagesGrid,children:a.map(e=>s.jsx(N,{language:e,downloading:c[e.locale],onDownload:()=>v(e.locale,e.name)},e.locale))}),s.jsxs("div",{style:S.infoBox,children:[s.jsx(r,{size:20,color:"#667eea"}),s.jsxs("div",{children:[s.jsx("strong",{children:"How it works:"})," DirectPay Go uses WooCommerce translation files to automatically translate checkout fields, buttons, and messages. Download the translation files for languages you want to support. English is the default language and doesn't require a translation file."]})]})]})},N=({language:e,downloading:i,onDownload:n})=>{const{locale:a,name:t,flag:l,isDefault:o,installed:r}=e,d=o||r;return s.jsxs("div",{style:{...S.languageCard,...d?S.languageCardInstalled:S.languageCardNotInstalled},children:[s.jsxs("div",{style:S.languageHeader,children:[s.jsx("span",{style:S.languageFlag,children:l}),s.jsx("h3",{style:S.languageName,children:t}),s.jsx("span",{style:{...S.statusBadge,...d?S.statusBadgeSuccess:S.statusBadgeWarning},children:o?"âœ“ Default":d?"âœ“ Installed":"âœ— Not Installed"})]}),s.jsxs("div",{style:S.languageDetails,children:[s.jsxs("div",{style:S.detailRow,children:[s.jsx("span",{style:S.detailLabel,children:"Locale:"}),s.jsx("span",{style:S.detailValue,children:a})]}),o?s.jsxs("div",{style:S.detailRow,children:[s.jsx("span",{style:S.detailLabel,children:"Status:"}),s.jsx("span",{style:S.detailValue,children:"Default language (no translation needed)"})]}):s.jsxs("div",{style:S.detailRow,children:[s.jsx("span",{style:S.detailLabel,children:"File:"}),s.jsxs("span",{style:S.detailValue,children:["woocommerce-",a,".mo"]})]})]}),!o&&s.jsx("div",{style:S.languageActions,children:d?s.jsx("button",{style:S.redownloadButton,onClick:n,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx(p,{size:16,style:{animation:"spin 1s linear infinite"}}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{size:16}),"Re-download"]})}):s.jsx("button",{style:S.downloadButton,onClick:n,disabled:i,children:i?s.jsxs(s.Fragment,{children:[s.jsx(p,{size:16,style:{animation:"spin 1s linear infinite"}}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(x,{size:16}),"Download Translation"]})})})]})},S={loading:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"24px",flexWrap:"wrap",gap:"16px"},title:{fontSize:"24px",fontWeight:"700",color:"#1f2937",margin:"0 0 8px 0"},subtitle:{fontSize:"14px",color:"#6b7280",lineHeight:"1.6",margin:0},badge:{padding:"8px 16px",background:"#667eea",color:"#fff",borderRadius:"20px",fontSize:"14px",fontWeight:"600"},statsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},statBox:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px"},statValue:{fontSize:"24px",fontWeight:"700",color:"#1f2937",lineHeight:"1"},statLabel:{fontSize:"13px",color:"#6b7280",marginTop:"4px"},bulkActions:{marginBottom:"24px"},bulkButton:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"12px 24px",background:"#667eea",color:"#fff",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},languagesGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"20px",marginBottom:"24px"},languageCard:{padding:"20px",borderRadius:"10px",border:"2px solid",transition:"all 0.3s ease"},languageCardInstalled:{borderColor:"#48bb78",background:"#f0fdf4"},languageCardNotInstalled:{borderColor:"#f59e0b",background:"#fffbeb"},languageHeader:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px",paddingBottom:"16px",borderBottom:"1px solid #e5e7eb"},languageFlag:{fontSize:"32px"},languageName:{flex:1,fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:0},statusBadge:{padding:"4px 12px",borderRadius:"12px",fontSize:"11px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px"},statusBadgeSuccess:{background:"#d1fae5",color:"#065f46"},statusBadgeWarning:{background:"#fef3c7",color:"#92400e"},languageDetails:{marginBottom:"16px"},detailRow:{display:"flex",justifyContent:"space-between",padding:"8px 0",fontSize:"14px"},detailLabel:{color:"#6b7280",fontWeight:"500"},detailValue:{color:"#1f2937",fontWeight:"400"},languageActions:{marginTop:"16px"},downloadButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"10px 16px",background:"#667eea",color:"#fff",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},redownloadButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"10px 16px",background:"#6b7280",color:"#fff",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},infoBox:{display:"flex",gap:"12px",padding:"16px",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"8px",fontSize:"14px",color:"#1e40af",lineHeight:"1.6"}},C={modal:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},backdrop:{position:"absolute",inset:0,background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)"},content:{position:"relative",background:"#ffffff",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",maxWidth:"448px",width:"100%",overflow:"hidden",animation:"slideUp 0.3s ease-out"},header:{padding:"24px",borderBottom:"1px solid #f3f4f6"},title:{fontSize:"20px",fontWeight:"600",color:"#111827",margin:0},body:{padding:"24px"},message:{color:"#6b7280",lineHeight:"1.6",margin:0},footer:{padding:"24px",background:"#f9fafb",display:"flex",gap:"12px",justifyContent:"flex-end"},buttonCancel:{padding:"8px 16px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",cursor:"pointer",border:"1px solid #d1d5db",background:"#ffffff",color:"#374151",transition:"all 0.2s"},buttonConfirm:e=>{const s={danger:{bg:"#ef4444",hover:"#dc2626"},warning:{bg:"#f59e0b",hover:"#d97706"},info:{bg:"#3b82f6",hover:"#2563eb"}};return{padding:"8px 16px",borderRadius:"8px",fontWeight:"500",fontSize:"14px",cursor:"pointer",border:"none",background:(s[e]||s.danger).bg,color:"#ffffff",transition:"all 0.2s"}}},z=({isOpen:e,onClose:i,onConfirm:n,title:a,message:t,confirmText:l="Confirm",cancelText:o="Cancel",type:r="danger"})=>e?s.jsxs("div",{style:C.modal,children:[s.jsx("div",{style:C.backdrop,onClick:i}),s.jsxs("div",{style:C.content,children:[s.jsx("div",{style:C.header,children:s.jsx("h3",{style:C.title,children:a})}),s.jsx("div",{style:C.body,children:s.jsx("p",{style:C.message,children:t})}),s.jsxs("div",{style:C.footer,children:[s.jsx("button",{onClick:i,style:C.buttonCancel,onMouseOver:e=>e.target.style.background="#f3f4f6",onMouseOut:e=>e.target.style.background="#ffffff",children:o}),s.jsx("button",{onClick:()=>{n(),i()},style:C.buttonConfirm(r),children:l})]})]}),s.jsx("style",{children:"\n        @keyframes slideUp {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "})]}):null,D=()=>{var i,n;const[a,r]=e.useState([]),[d,h]=e.useState(!0),[x,u]=e.useState("all"),[p,m]=e.useState(""),[v,y]=e.useState({isOpen:!1,sessionId:null,sessionName:""}),[b,w]=e.useState(null),k=(null==(i=window.directpayGoAdmin)?void 0:i.restUrl)+"directpay/v1",N=null==(n=window.directpayGoAdmin)?void 0:n.restNonce;e.useEffect(()=>{S();const e=setInterval(S,3e4);return()=>clearInterval(e)},[]);const S=async()=>{try{const e=await fetch(`${k}/admin/sessions`,{headers:{"X-WP-Nonce":N}}),s=await e.json();s.success&&r(s.sessions||[])}catch(e){console.error("Error:",e)}finally{h(!1)}},C=a.filter(e=>{var s,i,n;if(p){const a=p.toLowerCase(),t=null==(s=e.customer_name)?void 0:s.toLowerCase().includes(a),l=null==(i=e.customer_email)?void 0:i.toLowerCase().includes(a),o=null==(n=e.session_id)?void 0:n.toLowerCase().includes(a);if(!t&&!l&&!o)return!1}return"active"===x?(e.remaining_seconds||0)>3600:"expiring"!==x||(e.remaining_seconds||0)<=3600&&(e.remaining_seconds||0)>0}),D={total:a.length,active:a.filter(e=>(e.remaining_seconds||0)>3600).length,expiring:a.filter(e=>(e.remaining_seconds||0)<=3600&&(e.remaining_seconds||0)>0).length,totalOrders:a.reduce((e,s)=>e+(s.order_count||0),0)};return s.jsxs("div",{className:"sessions-tab",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"title",children:"Shipping Sessions"}),s.jsx("p",{className:"subtitle",children:"Monitor customer shopping sessions where shipping fee is charged only once within a time window."})]}),s.jsxs("button",{className:"refresh-button",onClick:S,children:[s.jsx(g,{size:16}),"Refresh"]})]}),s.jsxs("div",{className:"stats-grid",children:[s.jsx(M,{icon:l,label:"Total Sessions",value:D.total,color:"#475569"}),s.jsx(M,{icon:c,label:"Active Sessions",value:D.active,color:"#10b981"}),s.jsx(M,{icon:j,label:"Expiring Soon",value:D.expiring,color:"#f59e0b"}),s.jsx(M,{icon:t,label:"Total Orders",value:D.totalOrders,color:"#8b5cf6"})]}),s.jsxs("div",{className:"filter-section",children:[s.jsxs("div",{className:"search-box",children:[s.jsx(o,{size:18,className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Search by customer name, email, or session ID...",value:p,onChange:e=>m(e.target.value),className:"search-input"})]}),s.jsxs("div",{className:"filter-buttons",children:[s.jsx(B,{label:`All (${a.length})`,active:"all"===x,onClick:()=>u("all")}),s.jsx(B,{label:`Active (${D.active})`,active:"active"===x,onClick:()=>u("active")}),s.jsx(B,{label:`Expiring (${D.expiring})`,active:"expiring"===x,onClick:()=>u("expiring")})]})]}),d?s.jsx("div",{className:"loading-state",children:"Loading sessions..."}):0===C.length?s.jsxs("div",{className:"empty-state",children:[s.jsx(l,{size:48}),s.jsx("p",{children:p?"No sessions found":"No active sessions"})]}):s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"sessions-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Customer"}),s.jsx("th",{children:"Session ID"}),s.jsx("th",{children:"Orders"}),s.jsx("th",{children:"Time Left"}),s.jsx("th",{children:"Created"}),s.jsx("th",{className:"text-right",children:"Actions"})]})}),s.jsx("tbody",{children:C.map(e=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("div",{className:"customer-name",children:e.customer_name||"Guest"}),s.jsx("div",{className:"customer-email",children:e.customer_email||"N/A"})]}),s.jsx("td",{children:s.jsxs("code",{className:"session-code",children:[(e.session_id||"").substring(0,12),"..."]})}),s.jsx("td",{children:s.jsx("span",{className:"order-count",children:e.order_count||0})}),s.jsx("td",{children:s.jsx("span",{className:"time-badge "+((e.remaining_seconds||0)>3600?"active":"expiring"),children:e.remaining_formatted||"Expired"})}),s.jsx("td",{children:s.jsx("span",{className:"date-text",children:e.created_at?new Date(e.created_at).toLocaleString():"N/A"})}),s.jsx("td",{className:"text-right",children:s.jsxs("button",{className:"delete-button",onClick:()=>y({isOpen:!0,sessionId:e.session_id,sessionName:e.customer_name||"Guest"}),children:[s.jsx(f,{size:14}),"Delete"]})})]},e.session_id))})]})}),s.jsx(z,{isOpen:v.isOpen,onClose:()=>y({isOpen:!1,sessionId:null,sessionName:""}),onConfirm:()=>(async e=>{try{const s=await fetch(`${k}/admin/sessions/${e}`,{method:"DELETE",headers:{"X-WP-Nonce":N}});(await s.json()).success&&(r(a.filter(s=>s.session_id!==e)),y({isOpen:!1,sessionId:null,sessionName:""}))}catch(s){console.error("Error:",s)}})(v.sessionId),title:"Delete Session",message:`Are you sure you want to delete the session for ${v.sessionName}? This will end their free shipping window but won't affect existing orders.`,confirmText:"Delete",cancelText:"Cancel",type:"danger"})]})},M=({icon:e,label:i,value:n,color:a})=>s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",style:{background:`${a}20`},children:s.jsx(e,{size:24,color:a})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:n}),s.jsx("div",{className:"stat-label",children:i})]})]}),B=({label:e,active:i,onClick:n})=>s.jsx("button",{className:"filter-button "+(i?"active":""),onClick:n,children:e}),_=()=>{var i,n;const[a,t]=e.useState({enabled:!0,duration_hours:5}),[l,o]=e.useState(!0),[r,d]=e.useState(!1),[c,h]=e.useState(!1),[x,u]=e.useState(null),p=(null==(i=window.directpayGoAdmin)?void 0:i.restUrl)+"directpay/v1",g=null==(n=window.directpayGoAdmin)?void 0:n.restNonce;e.useEffect(()=>{m()},[]);const m=async()=>{try{const e=await fetch(`${p}/admin/session-settings`,{headers:{"X-WP-Nonce":g}}),s=await e.json();s.success&&t({enabled:s.enabled,duration_hours:s.duration_hours})}catch(e){console.error("Error:",e)}finally{o(!1)}},f=(e,s)=>{t(i=>({...i,[e]:s})),h(!0),u(null)};return l?s.jsx("div",{className:"settings-tab",children:s.jsx("div",{className:"loading",children:"Loading settings..."})}):s.jsxs("div",{className:"settings-tab",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"title",children:"Plugin Settings"}),s.jsx("p",{className:"subtitle",children:"Configure shipping session behavior and preferences."})]}),c&&s.jsxs("button",{className:"save-button",onClick:async()=>{d(!0),u(null);try{const e=await fetch(`${p}/admin/session-settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":g},body:JSON.stringify(a)});(await e.json()).success?(h(!1),u({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>u(null),3e3)):u({type:"error",text:"Failed to save settings"})}catch(e){console.error("Error:",e),u({type:"error",text:"Error saving settings"})}finally{d(!1)}},disabled:r,children:[s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),s.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),s.jsx("polyline",{points:"7 3 7 8 15 8"})]}),r?"Saving...":"Save Changes"]})]}),x&&s.jsxs("div",{className:`message ${x.type}`,children:["success"===x.type?s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("polyline",{points:"20 6 9 17 4 12"})}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),s.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),x.text]}),s.jsxs("div",{className:"section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 1v6m0 6v6m8.66-10.66l-5.2 3m-6.92 4l-5.2 3m0-13.32l5.2 3m6.92 4l5.2 3"})]}),s.jsx("h3",{className:"section-title",children:"Shipping Session Settings"})]}),s.jsxs("div",{className:"settings-grid",children:[s.jsxs("div",{className:"setting-card",children:[s.jsxs("div",{className:"setting-header",children:[s.jsxs("svg",{className:"icon "+(a.enabled?"active":"inactive"),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0"}),s.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"12"})]}),s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{className:"setting-title",children:"Enable Shipping Sessions"}),s.jsx("p",{className:"setting-description",children:"Allow customers to place multiple orders within a time window and pay shipping only once."})]})]}),s.jsx("div",{className:"setting-control",children:s.jsx("div",{onClick:()=>f("enabled",!a.enabled),className:"toggle "+(a.enabled?"active":""),children:s.jsx("div",{className:"toggle-thumb"})})})]}),s.jsxs("div",{className:"setting-card",children:[s.jsxs("div",{className:"setting-header",children:[s.jsxs("svg",{className:"icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("polyline",{points:"12 6 12 12 16 14"})]}),s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{className:"setting-title",children:"Session Duration"}),s.jsx("p",{className:"setting-description",children:"How long should a shipping session last? During this time, customers can place multiple orders without paying shipping again."})]})]}),s.jsx("div",{className:"setting-control",children:s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"number",min:"1",max:"48",value:a.duration_hours,onChange:e=>f("duration_hours",parseInt(e.target.value)||5),className:"input"}),s.jsx("span",{className:"input-suffix",children:"hours"})]})})]})]})]}),s.jsxs("div",{className:"section",children:[s.jsxs("h3",{className:"section-title",style:{marginBottom:"20px"},children:[s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),s.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),"How Shipping Sessions Work"]}),s.jsxs("div",{className:"info-box",children:[s.jsxs("ol",{className:"info-list",children:[s.jsx("li",{children:"Customer places their first order and pays for shipping"}),s.jsx("li",{children:"A session is created with the configured duration (default: 5 hours)"}),s.jsx("li",{children:"Customer can place additional orders within this timeframe"}),s.jsx("li",{children:"Subsequent orders in the same session have FREE shipping"}),s.jsx("li",{children:"Session expires after the duration ends"})]}),s.jsxs("div",{className:"info-note",children:[s.jsx("strong",{children:"Note:"})," This encourages customers to place multiple orders and increases your average order value."]})]})]})]})};class E extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,s){console.error("Error caught by boundary:",e,s),this.setState({error:e,errorInfo:s})}render(){var e,i;return this.state.hasError?s.jsxs("div",{style:{padding:20,background:"#fee",border:"1px solid #fcc",borderRadius:4},children:[s.jsx("h3",{style:{color:"#c00",margin:"0 0 10px 0"},children:"Something went wrong"}),s.jsx("p",{style:{margin:"0 0 10px 0"},children:null==(e=this.state.error)?void 0:e.toString()}),s.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),style:{padding:"8px 16px",cursor:"pointer"},children:"Try Again"}),s.jsxs("details",{style:{marginTop:10},children:[s.jsx("summary",{style:{cursor:"pointer"},children:"Error Details"}),s.jsx("pre",{style:{fontSize:12,overflow:"auto"},children:null==(i=this.state.errorInfo)?void 0:i.componentStack})]})]}):this.props.children}}const L=()=>{const[i,n]=e.useState("overview"),a=[{id:"overview",label:"Dashboard",icon:t},{id:"languages",label:"Languages",icon:u},{id:"sessions",label:"Sessions",icon:v},{id:"settings",label:"Settings",icon:m}];return s.jsxs("div",{className:"directpay-tabbed-dashboard",children:[s.jsx("div",{className:"tabs-container",children:s.jsx("div",{className:"tabs-list",children:a.map(e=>{const a=e.icon,t=i===e.id;return s.jsxs("button",{onClick:()=>n(e.id),className:"tab "+(t?"active":""),children:[s.jsx(a,{size:18,className:"tab-icon"}),s.jsx("span",{children:e.label})]},e.id)})})}),s.jsx("div",{className:"content",children:s.jsx(E,{children:(()=>{switch(i){case"overview":default:return s.jsx(y,{});case"languages":return s.jsx(k,{});case"sessions":return s.jsx(D,{});case"settings":return s.jsx(_,{})}})()})})]})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("directpay-sessions-root");if(e){i(e).render(s.jsx(n.StrictMode,{children:s.jsx(L,{})}))}});
